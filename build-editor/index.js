(()=>{"use strict";var e={n:t=>{var a=t&&t.__esModule?()=>t.default:()=>t;return e.d(a,{a}),a},d:(t,a)=>{for(var l in a)e.o(a,l)&&!e.o(t,l)&&Object.defineProperty(t,l,{enumerable:!0,get:a[l]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.React,a=window.wp.plugins,l=window.wp.editPost,o=window.wp.data,i=window.wp.element,s=window.wp.apiFetch;var n=e.n(s);const r=window.wp.components,c=({title:e,description:a,url:l})=>{const o=e.length>60?e.substring(0,57)+"...":e,i=a.length>160?a.substring(0,157)+"...":a||"No description provided. Add a meta description to control what appears here.";return(0,t.createElement)("div",{className:"wpseopilot-search-preview"},(0,t.createElement)("div",{className:"wpseopilot-search-preview__breadcrumb"},(0,t.createElement)("div",{className:"wpseopilot-search-preview__favicon"},(0,t.createElement)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none"},(0,t.createElement)("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2"}),(0,t.createElement)("path",{d:"M12 6v6l4 2",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}))),(0,t.createElement)("div",{className:"wpseopilot-search-preview__url-container"},(0,t.createElement)("span",{className:"wpseopilot-search-preview__site-name"},(()=>{try{return new URL(l).hostname.replace("www.","")}catch{return"example.com"}})()),(0,t.createElement)("span",{className:"wpseopilot-search-preview__url"},(e=>{try{const t=new URL(e),a="/"===t.pathname?"":t.pathname;return`${t.hostname}${a}`}catch{return e}})(l))),(0,t.createElement)("button",{type:"button",className:"wpseopilot-search-preview__menu","aria-label":"More options"},(0,t.createElement)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none"},(0,t.createElement)("circle",{cx:"12",cy:"5",r:"1.5",fill:"currentColor"}),(0,t.createElement)("circle",{cx:"12",cy:"12",r:"1.5",fill:"currentColor"}),(0,t.createElement)("circle",{cx:"12",cy:"19",r:"1.5",fill:"currentColor"})))),(0,t.createElement)("h3",{className:"wpseopilot-search-preview__title"},o||"Page Title"),(0,t.createElement)("p",{className:"wpseopilot-search-preview__description"},i))},p={excellent:"#00a32a",good:"#00a32a",fair:"#dba617",poor:"#d63638"},m=({score:e=0,level:a="poor"})=>{const l=p[a]||p.poor,o=2*Math.PI*20,i=o-e/100*o;return(0,t.createElement)("div",{className:"wpseopilot-gauge"},(0,t.createElement)("svg",{viewBox:"0 0 48 48",className:"wpseopilot-gauge__svg"},(0,t.createElement)("circle",{className:"wpseopilot-gauge__bg",cx:"24",cy:"24",r:"20",fill:"none",strokeWidth:"4"}),(0,t.createElement)("circle",{className:"wpseopilot-gauge__progress",cx:"24",cy:"24",r:"20",fill:"none",strokeWidth:"4",strokeDasharray:o,strokeDashoffset:i,strokeLinecap:"round",style:{stroke:l}})),(0,t.createElement)("div",{className:"wpseopilot-gauge__value",style:{color:l}},e))},d=({variables:e={},onSelect:a,context:l="post",buttonLabel:o="Variables",disabled:s=!1,compact:n=!1,isOpen:r,onToggle:c,onClose:p})=>{const[m,d]=(0,i.useState)(!1),[u,w]=(0,i.useState)(""),h=(0,i.useRef)(null),v=void 0!==r?r:m,E=e=>{void 0!==r?e?c?.():p?.():d(e)};(0,i.useEffect)(()=>{const e=e=>{h.current&&!h.current.contains(e.target)&&E(!1)};return v&&document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[v,r]);const g=e=>{a&&a(`{{${e.tag}}}`),E(!1),w("")},_=()=>{void 0!==r?c?.():d(!m)},b=v?(()=>{const t={},a={global:["global"],post:["global","post"],taxonomy:["global","taxonomy"],archive:["global","archive","author"],author:["global","author"],date:["global","archive"],search:["global"],404:["global"]}[l]||["global","post"];return Object.entries(e).forEach(([e,l])=>{if(!a.includes(e))return;const o=(l.vars||[]).filter(e=>{if(!u)return!0;const t=u.toLowerCase();return e.tag.toLowerCase().includes(t)||e.label.toLowerCase().includes(t)||e.desc&&e.desc.toLowerCase().includes(t)});o.length>0&&(t[e]={...l,vars:o})}),t})():{};return n?(0,t.createElement)("div",{className:"wpseopilot-variable-picker wpseopilot-variable-picker--compact",ref:h},(0,t.createElement)("button",{type:"button",className:"wpseopilot-template-input__action-btn wpseopilot-template-input__action-btn--vars",onClick:_,disabled:s,title:"Insert variable"},(0,t.createElement)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},(0,t.createElement)("path",{d:"M4 7h3a1 1 0 0 0 1-1V3"}),(0,t.createElement)("path",{d:"M20 7h-3a1 1 0 0 1-1-1V3"}),(0,t.createElement)("path",{d:"M4 17h3a1 1 0 0 1 1 1v3"}),(0,t.createElement)("path",{d:"M20 17h-3a1 1 0 0 0-1 1v3"}),(0,t.createElement)("path",{d:"M9 12h6"}),(0,t.createElement)("path",{d:"M12 9v6"}))),v&&(0,t.createElement)("div",{className:"wpseopilot-variable-picker__dropdown"},(0,t.createElement)("div",{className:"wpseopilot-variable-picker__search"},(0,t.createElement)("input",{type:"text",placeholder:"Search variables...",value:u,onChange:e=>w(e.target.value),autoFocus:!0})),(0,t.createElement)("div",{className:"wpseopilot-variable-picker__groups"},Object.entries(b).map(([e,a])=>(0,t.createElement)("div",{key:e,className:"wpseopilot-variable-picker__group"},(0,t.createElement)("div",{className:`wpseopilot-variable-picker__group-label wpseopilot-variable-picker__group-label--${e}`},a.label),(0,t.createElement)("div",{className:"wpseopilot-variable-picker__items"},a.vars.map(a=>(0,t.createElement)("button",{key:a.tag,type:"button",className:"wpseopilot-variable-picker__item",onClick:()=>g(a)},(0,t.createElement)("div",{className:"wpseopilot-variable-picker__item-header"},(0,t.createElement)("code",{className:`wpseopilot-variable-picker__tag wpseopilot-variable-picker__tag--${e}`},a.tag),(0,t.createElement)("span",{className:"wpseopilot-variable-picker__label"},a.label)),a.preview&&(0,t.createElement)("div",{className:"wpseopilot-variable-picker__preview"},a.preview)))))),0===Object.keys(b).length&&(0,t.createElement)("div",{className:"wpseopilot-variable-picker__empty"},"No variables found")))):(0,t.createElement)("div",{className:"wpseopilot-variable-picker",ref:h},(0,t.createElement)("button",{type:"button",className:"wpseopilot-variable-picker__trigger",onClick:_,disabled:s,title:"Insert variable"},(0,t.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",width:"16",height:"16"},(0,t.createElement)("path",{fillRule:"evenodd",d:"M4.5 2A2.5 2.5 0 002 4.5v3.879a2.5 2.5 0 00.732 1.767l7.5 7.5a2.5 2.5 0 003.536 0l3.878-3.878a2.5 2.5 0 000-3.536l-7.5-7.5A2.5 2.5 0 008.38 2H4.5zM5 6a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),(0,t.createElement)("span",null,o)),v&&(0,t.createElement)("div",{className:"wpseopilot-variable-picker__dropdown"},(0,t.createElement)("div",{className:"wpseopilot-variable-picker__search"},(0,t.createElement)("input",{type:"text",placeholder:"Search variables...",value:u,onChange:e=>w(e.target.value),autoFocus:!0})),(0,t.createElement)("div",{className:"wpseopilot-variable-picker__groups"},Object.entries(b).map(([e,a])=>(0,t.createElement)("div",{key:e,className:"wpseopilot-variable-picker__group"},(0,t.createElement)("div",{className:`wpseopilot-variable-picker__group-label wpseopilot-variable-picker__group-label--${e}`},a.label),(0,t.createElement)("div",{className:"wpseopilot-variable-picker__items"},a.vars.map(a=>(0,t.createElement)("button",{key:a.tag,type:"button",className:"wpseopilot-variable-picker__item",onClick:()=>g(a)},(0,t.createElement)("div",{className:"wpseopilot-variable-picker__item-header"},(0,t.createElement)("code",{className:`wpseopilot-variable-picker__tag wpseopilot-variable-picker__tag--${e}`},a.tag),(0,t.createElement)("span",{className:"wpseopilot-variable-picker__label"},a.label)),a.preview&&(0,t.createElement)("div",{className:"wpseopilot-variable-picker__preview"},a.preview)))))),0===Object.keys(b).length&&(0,t.createElement)("div",{className:"wpseopilot-variable-picker__empty"},"No variables found"))))},u={site_title:"global",tagline:"global",site_url:"global",separator:"separator",current_year:"global",current_month:"global",current_day:"global",post_title:"post",post_excerpt:"post",post_date:"post",post_modified:"post",post_author:"post",post_id:"post",post_content:"post",term_title:"taxonomy",term_description:"taxonomy",term_count:"taxonomy",author_name:"author",author_bio:"author",archive_title:"archive",search_query:"archive",page_number:"archive"},w=e=>{const t=e.indexOf("|");return t>-1?e.substring(0,t).trim():e.trim()},h=e=>{const t=w(e);return u[t]||"global"},v=({value:e="",onChange:a,placeholder:l="",variables:o={},variableValues:s={},context:n="post",multiline:r=!1,maxLength:c=null,label:p="",helpText:m="",id:u,disabled:v=!1,onAiClick:E=null,showAiButton:g=!0,aiEnabled:_=!0})=>{const b=(0,i.useRef)(null),N=(0,i.useRef)(null),[k,y]=(0,i.useState)(!1),[f,x]=(0,i.useState)(!1),[C,S]=(0,i.useState)(null);(0,i.useEffect)(()=>{const e=b.current,t=N.current;if(!e||!t)return;const a=()=>{t.scrollTop=e.scrollTop,t.scrollLeft=e.scrollLeft};return e.addEventListener("scroll",a),()=>e.removeEventListener("scroll",a)},[]);const P=(0,i.useMemo)(()=>{if(!e)return[];const t=[];let a=0;const l=/\{\{([^}]+)\}\}/g;let o;for(;null!==(o=l.exec(e));){o.index>a&&t.push({type:"text",content:e.slice(a,o.index)});const i=o[1].trim(),n=w(i),r=h(n),c=s[n]||s[`{{${n}}}`];t.push({type:"variable",fullTag:i,baseTag:n,raw:o[0],preview:c||n,varType:r}),a=l.lastIndex}return a<e.length&&t.push({type:"text",content:e.slice(a)}),t},[e,s]),M=e.length,A=c&&M>c,L=r?"textarea":"input";return(0,t.createElement)("div",{className:`wpseopilot-template-input ${k?"is-focused":""} ${v?"is-disabled":""}`},p&&(0,t.createElement)("div",{className:"wpseopilot-template-input__header"},(0,t.createElement)("label",{className:"wpseopilot-template-input__label",htmlFor:u},p),c&&(0,t.createElement)("span",{className:"wpseopilot-template-input__counter "+(A?"over-limit":M>0?"has-value":"")},M,"/",c)),(0,t.createElement)("div",{className:"wpseopilot-template-input__container"},(0,t.createElement)("div",{ref:N,className:"wpseopilot-template-input__highlight "+(r?"multiline":""),"aria-hidden":"true"},P.map((e,a)=>"variable"===e.type?(0,t.createElement)("span",{key:a,className:`wpseopilot-template-input__var wpseopilot-template-input__var--${e.varType}`,onMouseEnter:()=>S({...e,index:a}),onMouseLeave:()=>S(null)},(0,t.createElement)("span",{className:"wpseopilot-template-input__bracket"},"{"),(0,t.createElement)("span",{className:"wpseopilot-template-input__bracket"},"{"),(0,t.createElement)("span",{className:"wpseopilot-template-input__tag"},e.fullTag),(0,t.createElement)("span",{className:"wpseopilot-template-input__bracket"},"}"),(0,t.createElement)("span",{className:"wpseopilot-template-input__bracket"},"}"),C?.index===a&&e.preview&&(0,t.createElement)("span",{className:"wpseopilot-template-input__tooltip"},e.preview)):(0,t.createElement)("span",{key:a},e.content)),!e&&(0,t.createElement)("span",{className:"wpseopilot-template-input__placeholder"},l)),(0,t.createElement)(L,{ref:b,id:u,type:r?void 0:"text",className:"wpseopilot-template-input__field "+(r?"multiline":""),value:e,onChange:e=>a(e.target.value),onFocus:()=>y(!0),onBlur:()=>y(!1),placeholder:"",disabled:v,rows:r?3:void 0}),(0,t.createElement)("div",{className:"wpseopilot-template-input__actions"},g&&(0,t.createElement)("button",{type:"button",className:"wpseopilot-template-input__action-btn wpseopilot-template-input__action-btn--ai "+(_?"":"is-disabled"),onClick:()=>{_&&E?E():_||window.confirm("AI features require WP AI Pilot to be configured.\n\nWould you like to open the AI settings now?")&&window.open("admin.php?page=wp-ai-pilot","_blank")},disabled:v,title:"Generate with AI"},(0,t.createElement)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},(0,t.createElement)("path",{d:"M12 3v1m0 16v1m-9-9h1m16 0h1m-2.636-6.364l-.707.707M6.343 17.657l-.707.707m12.728 0l-.707-.707M6.343 6.343l-.707-.707"}),(0,t.createElement)("circle",{cx:"12",cy:"12",r:"4"}))),(0,t.createElement)(d,{variables:o,context:n,onSelect:t=>{const l=b.current;if(!l)return void a(e+t);const o=l.selectionStart,i=l.selectionEnd,s=e.slice(0,o)+t+e.slice(i);a(s),x(!1),requestAnimationFrame(()=>{const e=o+t.length;l.setSelectionRange(e,e),l.focus()})},disabled:v,isOpen:f,onToggle:()=>x(!f),onClose:()=>x(!1),compact:!0}))),m&&(0,t.createElement)("div",{className:"wpseopilot-template-input__footer"},(0,t.createElement)("span",{className:"wpseopilot-template-input__help"},m)))},E=({isOpen:e,onClose:a,onGenerate:l,fieldType:o="title",currentValue:s="",variableValues:r={},context:c={},postTitle:p="",postContent:m="",aiProvider:d="none",aiPilot:u=null})=>{const[w,h]=(0,i.useState)(!1),[v,E]=(0,i.useState)(null),[g,_]=(0,i.useState)(!0),[b,N]=(0,i.useState)(""),[k,y]=(0,i.useState)(null),f=(0,i.useCallback)(()=>{if(!g)return"";const e=[];p&&e.push(`Post title: ${p}`),c.type&&e.push(`Content type: ${c.type}`);const t=Object.entries(r).filter(([e,t])=>t&&"string"==typeof t).map(([e,t])=>`${e.replace(/_/g," ")}: ${t}`);if(t.length>0&&e.push(...t),m){const t=m.replace(/<[^>]*>/g,"").substring(0,500);t&&e.push(`Content preview: ${t}...`)}return e.join("\n")},[g,r,c,p,m]),x=async()=>{h(!0),E(null),y(null);try{let e="";e=b?b+"\n\n"+f():f()||"Generate SEO metadata for a website.",e+="title"===o?"\n\nGenerate an SEO-optimized title (max 60 characters).":"\n\nGenerate an SEO-optimized meta description (max 155 characters).";const t=await n()({path:"/wpseopilot/v2/ai/generate",method:"POST",data:{content:e,type:o}});if(t.success&&t.data){const e="title"===o?t.data.title:t.data.description;y(e)}else E(t.message||"Failed to generate content")}catch(e){E(e.message||"An error occurred during generation")}finally{h(!1)}},C=()=>{y(null),E(null),N(""),a()};return e?"none"===d?(0,t.createElement)("div",{className:"wpseopilot-ai-modal-overlay",onClick:C},(0,t.createElement)("div",{className:"wpseopilot-ai-modal wpseopilot-ai-modal--notice",onClick:e=>e.stopPropagation()},(0,t.createElement)("div",{className:"wpseopilot-ai-modal__header"},(0,t.createElement)("h3",null,(0,t.createElement)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2"},(0,t.createElement)("circle",{cx:"12",cy:"12",r:"10"}),(0,t.createElement)("path",{d:"M12 8v4m0 4h.01"})),"AI Not Configured"),(0,t.createElement)("button",{type:"button",className:"wpseopilot-ai-modal__close",onClick:C,"aria-label":"Close"},(0,t.createElement)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2"},(0,t.createElement)("path",{d:"M18 6L6 18M6 6l12 12"})))),(0,t.createElement)("div",{className:"wpseopilot-ai-modal__body"},u?.installed?(0,t.createElement)("div",{className:"wpseopilot-ai-notice wpseopilot-ai-notice--warning"},(0,t.createElement)("div",{className:"wpseopilot-ai-notice__icon"},(0,t.createElement)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2"},(0,t.createElement)("path",{d:"M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"}))),(0,t.createElement)("div",{className:"wpseopilot-ai-notice__content"},(0,t.createElement)("h4",null,"WP AI Pilot Needs Configuration"),(0,t.createElement)("p",null,"WP AI Pilot is installed but not yet configured. Add an API key to enable AI-powered SEO suggestions."))):(0,t.createElement)("div",{className:"wpseopilot-ai-notice wpseopilot-ai-notice--info"},(0,t.createElement)("div",{className:"wpseopilot-ai-notice__icon"},(0,t.createElement)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2"},(0,t.createElement)("path",{d:"M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"}))),(0,t.createElement)("div",{className:"wpseopilot-ai-notice__content"},(0,t.createElement)("h4",null,"Enhance with WP AI Pilot"),(0,t.createElement)("p",null,"Install WP AI Pilot to unlock AI-powered title and meta description generation.")))),(0,t.createElement)("div",{className:"wpseopilot-ai-modal__footer"},(0,t.createElement)("button",{type:"button",className:"wpseopilot-ai-modal__btn wpseopilot-ai-modal__btn--secondary",onClick:C},"Cancel"),u?.installed?(0,t.createElement)("a",{href:u.settingsUrl,className:"wpseopilot-ai-modal__btn wpseopilot-ai-modal__btn--primary"},"Configure WP AI Pilot"):(0,t.createElement)("a",{href:"/wp-admin/plugin-install.php?s=wp+ai+pilot&tab=search",className:"wpseopilot-ai-modal__btn wpseopilot-ai-modal__btn--primary"},"Install WP AI Pilot")))):(0,t.createElement)("div",{className:"wpseopilot-ai-modal-overlay",onClick:C},(0,t.createElement)("div",{className:"wpseopilot-ai-modal",onClick:e=>e.stopPropagation()},(0,t.createElement)("div",{className:"wpseopilot-ai-modal__header"},(0,t.createElement)("h3",null,(0,t.createElement)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2"},(0,t.createElement)("path",{d:"M12 3v1m0 16v1m-9-9h1m16 0h1m-2.636-6.364l-.707.707M6.343 17.657l-.707.707m12.728 0l-.707-.707M6.343 6.343l-.707-.707"}),(0,t.createElement)("circle",{cx:"12",cy:"12",r:"4"})),"Generate ","title"===o?"Title":"Description"),"wp-ai-pilot"===d&&(0,t.createElement)("span",{className:"wpseopilot-ai-badge"},(0,t.createElement)("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2"},(0,t.createElement)("path",{d:"M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"})),"WP AI Pilot"),(0,t.createElement)("button",{type:"button",className:"wpseopilot-ai-modal__close",onClick:C,"aria-label":"Close"},(0,t.createElement)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2"},(0,t.createElement)("path",{d:"M18 6L6 18M6 6l12 12"})))),(0,t.createElement)("div",{className:"wpseopilot-ai-modal__body"},(0,t.createElement)("div",{className:"wpseopilot-ai-modal__option"},(0,t.createElement)("label",{className:"wpseopilot-ai-modal__checkbox"},(0,t.createElement)("input",{type:"checkbox",checked:g,onChange:e=>_(e.target.checked)}),(0,t.createElement)("span",{className:"wpseopilot-ai-modal__checkbox-label"},"Include post content as context"))),g&&p&&(0,t.createElement)("div",{className:"wpseopilot-ai-modal__context-preview"},(0,t.createElement)("div",{className:"wpseopilot-ai-modal__context-item"},(0,t.createElement)("span",{className:"wpseopilot-ai-modal__context-key"},"Post:"),(0,t.createElement)("span",{className:"wpseopilot-ai-modal__context-value"},p))),(0,t.createElement)("div",{className:"wpseopilot-ai-modal__field"},(0,t.createElement)("label",{htmlFor:"ai-custom-prompt"},"Custom instructions (optional)"),(0,t.createElement)("textarea",{id:"ai-custom-prompt",value:b,onChange:e=>N(e.target.value),placeholder:`e.g., "Focus on ${"title"===o?"including keywords":"highlighting benefits"}"`,rows:2})),v&&(0,t.createElement)("div",{className:"wpseopilot-ai-modal__error"},(0,t.createElement)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2"},(0,t.createElement)("circle",{cx:"12",cy:"12",r:"10"}),(0,t.createElement)("path",{d:"M12 8v4m0 4h.01"})),v),k&&(0,t.createElement)("div",{className:"wpseopilot-ai-modal__result"},(0,t.createElement)("label",null,"Generated ","title"===o?"title":"description",":"),(0,t.createElement)("div",{className:"wpseopilot-ai-modal__result-box"},(0,t.createElement)("p",null,k),(0,t.createElement)("span",{className:"wpseopilot-ai-modal__char-count"},k.length," characters")))),(0,t.createElement)("div",{className:"wpseopilot-ai-modal__footer"},(0,t.createElement)("button",{type:"button",className:"wpseopilot-ai-modal__btn wpseopilot-ai-modal__btn--secondary",onClick:C},"Cancel"),k?(0,t.createElement)(t.Fragment,null,(0,t.createElement)("button",{type:"button",className:"wpseopilot-ai-modal__btn",onClick:x,disabled:w},"Regenerate"),(0,t.createElement)("button",{type:"button",className:"wpseopilot-ai-modal__btn wpseopilot-ai-modal__btn--primary",onClick:()=>{k&&(l(k),C())}},"Apply")):(0,t.createElement)("button",{type:"button",className:"wpseopilot-ai-modal__btn wpseopilot-ai-modal__btn--primary",onClick:x,disabled:w},w?(0,t.createElement)(t.Fragment,null,(0,t.createElement)("span",{className:"wpseopilot-ai-modal__spinner"}),"Generating..."):(0,t.createElement)(t.Fragment,null,(0,t.createElement)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2"},(0,t.createElement)("path",{d:"M12 3v1m0 16v1m-9-9h1m16 0h1m-2.636-6.364l-.707.707M6.343 17.657l-.707.707m12.728 0l-.707-.707M6.343 6.343l-.707-.707"}),(0,t.createElement)("circle",{cx:"12",cy:"12",r:"4"})),"Generate"))))):null},g=({metric:e})=>{const a=e.max>0?e.score/e.max*100:0,l=e.is_pass?"pass":e.score>0?"partial":"fail";return(0,t.createElement)("li",{className:`wpseopilot-metric-item wpseopilot-metric-item--${l}`},(0,t.createElement)("div",{className:"wpseopilot-metric-item__header"},(0,t.createElement)("span",{className:`wpseopilot-metric-item__indicator wpseopilot-metric-item__indicator--${l}`}),(0,t.createElement)("span",{className:"wpseopilot-metric-item__label"},e.label),(0,t.createElement)("span",{className:"wpseopilot-metric-item__score"},e.score,"/",e.max)),(0,t.createElement)("div",{className:"wpseopilot-metric-item__status"},e.status),(0,t.createElement)("div",{className:"wpseopilot-metric-item__bar"},(0,t.createElement)("div",{className:`wpseopilot-metric-item__fill wpseopilot-metric-item__fill--${l}`,style:{width:`${a}%`}})))},_=({metrics:e,metricsByCategory:a,hasKeyphrase:l})=>{const o=[{key:"basic",icon:"ðŸ“Š",color:"#2271b1",label:"Basic SEO"},{key:"keyword",icon:"ðŸ”‘",color:"#7c3aed",label:"Keywords"},{key:"structure",icon:"ðŸ“",color:"#059669",label:"Structure"},{key:"links",icon:"ðŸ”—",color:"#ea580c",label:"Links & Media"}],i=l?o:o.filter(e=>"keyword"!==e.key);return(0,t.createElement)("div",{className:"wpseopilot-metrics-breakdown"},i.map(e=>{const l=a?.[e.key];if(!l||0===l.items.length)return null;const o=(e=>{if(!e||0===e.length)return 0;const t=e.reduce((e,t)=>e+(t.score||0),0),a=e.reduce((e,t)=>e+(t.max||0),0);return a>0?Math.round(t/a*100):0})(l.items),i=o>=80?"good":o>=50?"fair":"poor";return(0,t.createElement)("div",{key:e.key,className:"wpseopilot-metric-group"},(0,t.createElement)("div",{className:"wpseopilot-metric-group__header",style:{borderLeftColor:e.color}},(0,t.createElement)("span",{className:"wpseopilot-metric-group__icon"},e.icon),(0,t.createElement)("span",{className:"wpseopilot-metric-group__label"},l.label||e.label),(0,t.createElement)("span",{className:`wpseopilot-metric-group__score wpseopilot-metric-group__score--${i}`},(s=l.items)&&0!==s.length?`${s.reduce((e,t)=>e+(t.score||0),0)}/${s.reduce((e,t)=>e+(t.max||0),0)}`:"0/0")),(0,t.createElement)("ul",{className:"wpseopilot-metric-list"},l.items.map(e=>(0,t.createElement)(g,{key:e.key,metric:e}))));var s}),!l&&(0,t.createElement)("div",{className:"wpseopilot-keyphrase-notice"},(0,t.createElement)("span",{className:"wpseopilot-keyphrase-notice__icon"},"ðŸ’¡"),(0,t.createElement)("div",{className:"wpseopilot-keyphrase-notice__content"},(0,t.createElement)("strong",null,"Add a focus keyphrase"),(0,t.createElement)("p",null,"Set a target keyword to unlock 5 additional optimization checks including keyword density and placement analysis."))))},b=({seoMeta:e,updateMeta:a,seoScore:l,effectiveTitle:o,effectiveDescription:s,postUrl:n,postTitle:p,postContent:d,featuredImage:u,hasChanges:w,variables:h,variableValues:g,aiEnabled:b,aiProvider:N="none",aiPilot:k=null})=>{const[y,f]=(0,i.useState)("general"),[x,C]=(0,i.useState)({isOpen:!1,fieldType:"title",onApply:null}),S=((e.title||"").length,(e.description||"").length,(0,i.useCallback)((e,t)=>{C({isOpen:!0,fieldType:e,onApply:t})},[])),P=(0,i.useCallback)(()=>{C({isOpen:!1,fieldType:"title",onApply:null})},[]),M=(0,i.useCallback)(e=>{x.onApply&&e&&x.onApply(e),P()},[x,P]);return(0,t.createElement)("div",{className:"wpseopilot-editor-panel"},(0,t.createElement)("div",{className:"wpseopilot-score-header"},(0,t.createElement)(m,{score:l?.score||0,level:l?.level||"poor"}),(0,t.createElement)("div",{className:"wpseopilot-score-info"},(0,t.createElement)("div",{className:"wpseopilot-score-label"},"SEO Score"),(0,t.createElement)("div",{className:"wpseopilot-score-status"},l?.issues?.length>0?`${l.issues.length} issue${1!==l.issues.length?"s":""} found`:"Looking good!"),!e.focus_keyphrase&&(0,t.createElement)("div",{className:"wpseopilot-keyphrase-hint"},"Add keyphrase for full analysis"))),(0,t.createElement)("div",{className:"wpseopilot-tabs"},(0,t.createElement)("button",{type:"button",className:"wpseopilot-tab "+("general"===y?"active":""),onClick:()=>f("general")},"General"),(0,t.createElement)("button",{type:"button",className:"wpseopilot-tab "+("analysis"===y?"active":""),onClick:()=>f("analysis")},"Analysis"),(0,t.createElement)("button",{type:"button",className:"wpseopilot-tab "+("advanced"===y?"active":""),onClick:()=>f("advanced")},"Advanced"),(0,t.createElement)("button",{type:"button",className:"wpseopilot-tab "+("social"===y?"active":""),onClick:()=>f("social")},"Social")),"general"===y&&(0,t.createElement)("div",{className:"wpseopilot-tab-content"},(0,t.createElement)("div",{className:"wpseopilot-preview-section"},(0,t.createElement)("label",{className:"wpseopilot-section-label"},"Search Preview"),(0,t.createElement)(c,{title:o,description:s,url:n})),(0,t.createElement)("div",{className:"wpseopilot-field wpseopilot-field--keyphrase"},(0,t.createElement)("div",{className:"wpseopilot-field-header"},(0,t.createElement)("label",null,"Focus Keyphrase")),(0,t.createElement)("input",{type:"text",className:"wpseopilot-field-input",value:e.focus_keyphrase||"",onChange:e=>a("focus_keyphrase",e.target.value),placeholder:"Enter your target keyword"}),(0,t.createElement)("p",{className:"wpseopilot-field-help"},"The main keyword you want this page to rank for")),(0,t.createElement)(v,{label:"SEO Title",id:"wpseopilot-seo-title",value:e.title||"",onChange:e=>a("title",e),placeholder:p||"Enter SEO title",maxLength:60,variables:h,variableValues:g,context:"post",showAiButton:!0,aiEnabled:b,onAiClick:()=>S("title",e=>a("title",e))}),(0,t.createElement)(v,{label:"Meta Description",id:"wpseopilot-meta-desc",value:e.description||"",onChange:e=>a("description",e),placeholder:"Enter meta description",maxLength:160,multiline:!0,variables:h,variableValues:g,context:"post",showAiButton:!0,aiEnabled:b,onAiClick:()=>S("description",e=>a("description",e))}),l?.issues?.length>0&&(0,t.createElement)("div",{className:"wpseopilot-issues"},(0,t.createElement)("label",{className:"wpseopilot-section-label"},"Issues"),(0,t.createElement)("ul",{className:"wpseopilot-issues-list"},l.issues.slice(0,5).map((e,a)=>(0,t.createElement)("li",{key:a,className:`wpseopilot-issue wpseopilot-issue--${e.severity||"warning"}`},(0,t.createElement)("span",{className:"wpseopilot-issue-icon"},"high"===e.severity?"!":"?"),(0,t.createElement)("span",{className:"wpseopilot-issue-text"},e.message)))),l.issues.length>5&&(0,t.createElement)("button",{type:"button",className:"wpseopilot-view-all-link",onClick:()=>f("analysis")},"View all ",l.issues.length," issues â†’"))),"analysis"===y&&(0,t.createElement)("div",{className:"wpseopilot-tab-content"},(0,t.createElement)(_,{metrics:l?.metrics||[],metricsByCategory:l?.metrics_by_category,hasKeyphrase:!!e.focus_keyphrase})),"advanced"===y&&(0,t.createElement)("div",{className:"wpseopilot-tab-content"},(0,t.createElement)("div",{className:"wpseopilot-field"},(0,t.createElement)("div",{className:"wpseopilot-field-header"},(0,t.createElement)("label",null,"Canonical URL")),(0,t.createElement)("input",{type:"url",className:"wpseopilot-field-input",value:e.canonical||"",onChange:e=>a("canonical",e.target.value),placeholder:n}),(0,t.createElement)("p",{className:"wpseopilot-field-help"},"Leave empty to use the default URL")),(0,t.createElement)("div",{className:"wpseopilot-robots-section"},(0,t.createElement)("label",{className:"wpseopilot-section-label"},"Search Engine Visibility"),(0,t.createElement)("label",{className:"wpseopilot-toggle"},(0,t.createElement)("input",{type:"checkbox",checked:e.noindex||!1,onChange:e=>a("noindex",e.target.checked)}),(0,t.createElement)("span",{className:"wpseopilot-toggle-slider"}),(0,t.createElement)("span",{className:"wpseopilot-toggle-label"},"Hide from search results",(0,t.createElement)("small",null,"Add noindex meta tag"))),(0,t.createElement)("label",{className:"wpseopilot-toggle"},(0,t.createElement)("input",{type:"checkbox",checked:e.nofollow||!1,onChange:e=>a("nofollow",e.target.checked)}),(0,t.createElement)("span",{className:"wpseopilot-toggle-slider"}),(0,t.createElement)("span",{className:"wpseopilot-toggle-label"},"Don't follow links",(0,t.createElement)("small",null,"Add nofollow meta tag")))),(0,t.createElement)("div",{className:"wpseopilot-robots-preview"},(0,t.createElement)("label",{className:"wpseopilot-section-label"},"Robots Meta"),(0,t.createElement)("code",{className:"wpseopilot-robots-code"},e.noindex||e.nofollow?`${e.noindex?"noindex":"index"}, ${e.nofollow?"nofollow":"follow"}`:"index, follow (default)"))),"social"===y&&(0,t.createElement)("div",{className:"wpseopilot-tab-content"},(0,t.createElement)("div",{className:"wpseopilot-social-preview"},(0,t.createElement)("label",{className:"wpseopilot-section-label"},"Social Preview"),(0,t.createElement)("div",{className:"wpseopilot-social-card"},(0,t.createElement)("div",{className:"wpseopilot-social-image"},e.og_image||u?(0,t.createElement)("img",{src:e.og_image||u,alt:""}):(0,t.createElement)("div",{className:"wpseopilot-social-placeholder"},(0,t.createElement)("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none"},(0,t.createElement)("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",stroke:"currentColor",strokeWidth:"2"}),(0,t.createElement)("circle",{cx:"8.5",cy:"8.5",r:"1.5",fill:"currentColor"}),(0,t.createElement)("path",{d:"M21 15l-5-5L5 21",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})),(0,t.createElement)("span",null,"No image set"))),(0,t.createElement)("div",{className:"wpseopilot-social-content"},(0,t.createElement)("div",{className:"wpseopilot-social-url"},new URL(n).hostname),(0,t.createElement)("div",{className:"wpseopilot-social-title"},o),(0,t.createElement)("div",{className:"wpseopilot-social-desc"},s||"No description available")))),(0,t.createElement)("div",{className:"wpseopilot-field"},(0,t.createElement)("div",{className:"wpseopilot-field-header"},(0,t.createElement)("label",null,"Social Image URL")),(0,t.createElement)("input",{type:"url",className:"wpseopilot-field-input",value:e.og_image||"",onChange:e=>a("og_image",e.target.value),placeholder:"https://..."}),(0,t.createElement)("p",{className:"wpseopilot-field-help"},"1200x630 recommended. Leave empty to use featured image."),!e.og_image&&u&&(0,t.createElement)("p",{className:"wpseopilot-field-note"},"Using featured image as fallback")),(0,t.createElement)(r.Button,{variant:"secondary",className:"wpseopilot-media-button",onClick:()=>{const e=wp.media({title:"Select Social Image",button:{text:"Use Image"},multiple:!1});e.on("select",()=>{const t=e.state().get("selection").first().toJSON();a("og_image",t.url)}),e.open()}},(0,t.createElement)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",style:{marginRight:"6px"}},(0,t.createElement)("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",stroke:"currentColor",strokeWidth:"2"}),(0,t.createElement)("circle",{cx:"8.5",cy:"8.5",r:"1.5",fill:"currentColor"}),(0,t.createElement)("path",{d:"M21 15l-5-5L5 21",stroke:"currentColor",strokeWidth:"2"})),"Select Image")),(0,t.createElement)(E,{isOpen:x.isOpen,onClose:P,onGenerate:M,fieldType:x.fieldType,currentValue:"title"===x.fieldType?e.title:e.description,postTitle:p,postContent:d,variableValues:g,aiProvider:N,aiPilot:k}))},N=()=>(0,t.createElement)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,t.createElement)("path",{d:"M21 16v-2l-8-5V3.5c0-.83-.67-1.5-1.5-1.5S10 2.67 10 3.5V9l-8 5v2l8-2.5V19l-2 1.5V22l3.5-1 3.5 1v-1.5L13 19v-5.5l8 2.5z",fill:"currentColor"})),k=window.wpseopilotEditor||{},y=k.variables||{},f=k.aiEnabled||!1,x=k.aiProvider||"none",C=k.aiPilot||null;(0,a.registerPlugin)("wpseopilot",{render:()=>{const[e,a]=(0,i.useState)({title:"",description:"",canonical:"",noindex:!1,nofollow:!1,og_image:"",focus_keyphrase:""}),[s,r]=(0,i.useState)(null),[c,p]=(0,i.useState)(!1),[m,d]=(0,i.useState)(!1),[u,w]=(0,i.useState)({}),{postId:h,postTitle:v,postExcerpt:E,postContent:g,postType:_,postSlug:S,featuredImage:P}=(0,o.useSelect)(e=>{const t=e("core/editor"),a=t.getCurrentPost(),l=t.getEditedPostAttribute("featured_media");let o="";if(l){const t=e("core").getMedia(l);t&&(o=t.source_url)}return{postId:t.getCurrentPostId(),postTitle:t.getEditedPostAttribute("title")||"",postExcerpt:t.getEditedPostAttribute("excerpt")||"",postContent:t.getEditedPostContent()||"",postType:t.getCurrentPostType(),postSlug:a?.slug||"",featuredImage:o}},[]),{editPost:M}=(0,o.useDispatch)("core/editor");(0,i.useEffect)(()=>{if(!h||!_)return;const e={post:"posts",page:"pages",attachment:"media"}[t=_]||t;var t;n()({path:`/wp/v2/${e}/${h}`}).then(e=>{if(e.meta&&e.meta._wpseopilot_meta){const t=e.meta._wpseopilot_meta;a({title:t.title||"",description:t.description||"",canonical:t.canonical||"",noindex:"1"===t.noindex,nofollow:"1"===t.nofollow,og_image:t.og_image||"",focus_keyphrase:t.focus_keyphrase||""})}}).catch(()=>{})},[h,_]),(0,i.useEffect)(()=>{if(!h)return;const e=setTimeout(()=>{n()({path:`/wpseopilot/v2/audit/post/${h}`}).then(e=>{e.success&&e.data&&r(e.data)}).catch(()=>{})},500);return()=>clearTimeout(e)},[h,e,v,g]),(0,i.useEffect)(()=>{const e={post_title:v||"",post_excerpt:E||"",site_title:k.siteTitle||"",tagline:k.tagline||"",separator:k.separator||"-",current_year:(new Date).getFullYear().toString()};w(e)},[v,E]);const A=(0,i.useCallback)((t,l)=>{a(e=>({...e,[t]:l})),d(!0);const o={...e,[t]:l},i={title:o.title,description:o.description,canonical:o.canonical,noindex:o.noindex?"1":"",nofollow:o.nofollow?"1":"",og_image:o.og_image,focus_keyphrase:o.focus_keyphrase};M({meta:{_wpseopilot_meta:i}})},[e,M]),L=e.title||v||"Untitled",T=e.description||E||"",I=window.location.origin,$=S?`${I}/${S}/`:I;return(0,t.createElement)(t.Fragment,null,(0,t.createElement)(l.PluginSidebarMoreMenuItem,{target:"wpseopilot-sidebar",icon:(0,t.createElement)(N,null)},"WP SEO Pilot"),(0,t.createElement)(l.PluginSidebar,{name:"wpseopilot-sidebar",title:"WP SEO Pilot",icon:(0,t.createElement)(N,null)},(0,t.createElement)(b,{seoMeta:e,updateMeta:A,seoScore:s,effectiveTitle:L,effectiveDescription:T,postUrl:$,postTitle:v,postContent:g,featuredImage:P,hasChanges:m,variables:y,variableValues:u,aiEnabled:f,aiProvider:x,aiPilot:C})))},icon:(0,t.createElement)(N,null)})})();