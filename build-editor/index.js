(()=>{"use strict";var e={n:t=>{var l=t&&t.__esModule?()=>t.default:()=>t;return e.d(l,{a:l}),l},d:(t,l)=>{for(var a in l)e.o(l,a)&&!e.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:l[a]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.React,l=window.wp.plugins,a=window.wp.editPost,o=window.wp.data,i=window.wp.element,s=window.wp.apiFetch;var n=e.n(s);const r=window.wp.components,c=({title:e,description:l,url:a})=>{const o=e.length>60?e.substring(0,57)+"...":e,i=l.length>160?l.substring(0,157)+"...":l||"No description provided. Add a meta description to control what appears here.";return(0,t.createElement)("div",{className:"wpseopilot-search-preview"},(0,t.createElement)("div",{className:"wpseopilot-search-preview__breadcrumb"},(0,t.createElement)("div",{className:"wpseopilot-search-preview__favicon"},(0,t.createElement)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none"},(0,t.createElement)("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2"}),(0,t.createElement)("path",{d:"M12 6v6l4 2",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}))),(0,t.createElement)("div",{className:"wpseopilot-search-preview__url-container"},(0,t.createElement)("span",{className:"wpseopilot-search-preview__site-name"},(()=>{try{return new URL(a).hostname.replace("www.","")}catch{return"example.com"}})()),(0,t.createElement)("span",{className:"wpseopilot-search-preview__url"},(e=>{try{const t=new URL(e),l="/"===t.pathname?"":t.pathname;return`${t.hostname}${l}`}catch{return e}})(a))),(0,t.createElement)("button",{type:"button",className:"wpseopilot-search-preview__menu","aria-label":"More options"},(0,t.createElement)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none"},(0,t.createElement)("circle",{cx:"12",cy:"5",r:"1.5",fill:"currentColor"}),(0,t.createElement)("circle",{cx:"12",cy:"12",r:"1.5",fill:"currentColor"}),(0,t.createElement)("circle",{cx:"12",cy:"19",r:"1.5",fill:"currentColor"})))),(0,t.createElement)("h3",{className:"wpseopilot-search-preview__title"},o||"Page Title"),(0,t.createElement)("p",{className:"wpseopilot-search-preview__description"},i))},p={excellent:"#00a32a",good:"#00a32a",fair:"#dba617",poor:"#d63638"},m=({score:e=0,level:l="poor"})=>{const a=p[l]||p.poor,o=2*Math.PI*20,i=o-e/100*o;return(0,t.createElement)("div",{className:"wpseopilot-gauge"},(0,t.createElement)("svg",{viewBox:"0 0 48 48",className:"wpseopilot-gauge__svg"},(0,t.createElement)("circle",{className:"wpseopilot-gauge__bg",cx:"24",cy:"24",r:"20",fill:"none",strokeWidth:"4"}),(0,t.createElement)("circle",{className:"wpseopilot-gauge__progress",cx:"24",cy:"24",r:"20",fill:"none",strokeWidth:"4",strokeDasharray:o,strokeDashoffset:i,strokeLinecap:"round",style:{stroke:a}})),(0,t.createElement)("div",{className:"wpseopilot-gauge__value",style:{color:a}},e))},d=({variables:e={},onSelect:l,context:a="post",buttonLabel:o="Variables",disabled:s=!1,compact:n=!1,isOpen:r,onToggle:c,onClose:p})=>{const[m,d]=(0,i.useState)(!1),[u,w]=(0,i.useState)(""),v=(0,i.useRef)(null),h=void 0!==r?r:m,E=e=>{void 0!==r?e?c?.():p?.():d(e)};(0,i.useEffect)(()=>{const e=e=>{v.current&&!v.current.contains(e.target)&&E(!1)};return h&&document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[h,r]);const g=e=>{l&&l(`{{${e.tag}}}`),E(!1),w("")},_=()=>{void 0!==r?c?.():d(!m)},b=h?(()=>{const t={},l={global:["global"],post:["global","post"],taxonomy:["global","taxonomy"],archive:["global","archive","author"],author:["global","author"],date:["global","archive"],search:["global"],404:["global"]}[a]||["global","post"];return Object.entries(e).forEach(([e,a])=>{if(!l.includes(e))return;const o=(a.vars||[]).filter(e=>{if(!u)return!0;const t=u.toLowerCase();return e.tag.toLowerCase().includes(t)||e.label.toLowerCase().includes(t)||e.desc&&e.desc.toLowerCase().includes(t)});o.length>0&&(t[e]={...a,vars:o})}),t})():{};return n?(0,t.createElement)("div",{className:"wpseopilot-variable-picker wpseopilot-variable-picker--compact",ref:v},(0,t.createElement)("button",{type:"button",className:"wpseopilot-template-input__action-btn wpseopilot-template-input__action-btn--vars",onClick:_,disabled:s,title:"Insert variable"},(0,t.createElement)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},(0,t.createElement)("path",{d:"M4 7h3a1 1 0 0 0 1-1V3"}),(0,t.createElement)("path",{d:"M20 7h-3a1 1 0 0 1-1-1V3"}),(0,t.createElement)("path",{d:"M4 17h3a1 1 0 0 1 1 1v3"}),(0,t.createElement)("path",{d:"M20 17h-3a1 1 0 0 0-1 1v3"}),(0,t.createElement)("path",{d:"M9 12h6"}),(0,t.createElement)("path",{d:"M12 9v6"}))),h&&(0,t.createElement)("div",{className:"wpseopilot-variable-picker__dropdown"},(0,t.createElement)("div",{className:"wpseopilot-variable-picker__search"},(0,t.createElement)("input",{type:"text",placeholder:"Search variables...",value:u,onChange:e=>w(e.target.value),autoFocus:!0})),(0,t.createElement)("div",{className:"wpseopilot-variable-picker__groups"},Object.entries(b).map(([e,l])=>(0,t.createElement)("div",{key:e,className:"wpseopilot-variable-picker__group"},(0,t.createElement)("div",{className:`wpseopilot-variable-picker__group-label wpseopilot-variable-picker__group-label--${e}`},l.label),(0,t.createElement)("div",{className:"wpseopilot-variable-picker__items"},l.vars.map(l=>(0,t.createElement)("button",{key:l.tag,type:"button",className:"wpseopilot-variable-picker__item",onClick:()=>g(l)},(0,t.createElement)("div",{className:"wpseopilot-variable-picker__item-header"},(0,t.createElement)("code",{className:`wpseopilot-variable-picker__tag wpseopilot-variable-picker__tag--${e}`},l.tag),(0,t.createElement)("span",{className:"wpseopilot-variable-picker__label"},l.label)),l.preview&&(0,t.createElement)("div",{className:"wpseopilot-variable-picker__preview"},l.preview)))))),0===Object.keys(b).length&&(0,t.createElement)("div",{className:"wpseopilot-variable-picker__empty"},"No variables found")))):(0,t.createElement)("div",{className:"wpseopilot-variable-picker",ref:v},(0,t.createElement)("button",{type:"button",className:"wpseopilot-variable-picker__trigger",onClick:_,disabled:s,title:"Insert variable"},(0,t.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",width:"16",height:"16"},(0,t.createElement)("path",{fillRule:"evenodd",d:"M4.5 2A2.5 2.5 0 002 4.5v3.879a2.5 2.5 0 00.732 1.767l7.5 7.5a2.5 2.5 0 003.536 0l3.878-3.878a2.5 2.5 0 000-3.536l-7.5-7.5A2.5 2.5 0 008.38 2H4.5zM5 6a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),(0,t.createElement)("span",null,o)),h&&(0,t.createElement)("div",{className:"wpseopilot-variable-picker__dropdown"},(0,t.createElement)("div",{className:"wpseopilot-variable-picker__search"},(0,t.createElement)("input",{type:"text",placeholder:"Search variables...",value:u,onChange:e=>w(e.target.value),autoFocus:!0})),(0,t.createElement)("div",{className:"wpseopilot-variable-picker__groups"},Object.entries(b).map(([e,l])=>(0,t.createElement)("div",{key:e,className:"wpseopilot-variable-picker__group"},(0,t.createElement)("div",{className:`wpseopilot-variable-picker__group-label wpseopilot-variable-picker__group-label--${e}`},l.label),(0,t.createElement)("div",{className:"wpseopilot-variable-picker__items"},l.vars.map(l=>(0,t.createElement)("button",{key:l.tag,type:"button",className:"wpseopilot-variable-picker__item",onClick:()=>g(l)},(0,t.createElement)("div",{className:"wpseopilot-variable-picker__item-header"},(0,t.createElement)("code",{className:`wpseopilot-variable-picker__tag wpseopilot-variable-picker__tag--${e}`},l.tag),(0,t.createElement)("span",{className:"wpseopilot-variable-picker__label"},l.label)),l.preview&&(0,t.createElement)("div",{className:"wpseopilot-variable-picker__preview"},l.preview)))))),0===Object.keys(b).length&&(0,t.createElement)("div",{className:"wpseopilot-variable-picker__empty"},"No variables found"))))},u={site_title:"global",tagline:"global",site_url:"global",separator:"separator",current_year:"global",current_month:"global",current_day:"global",post_title:"post",post_excerpt:"post",post_date:"post",post_modified:"post",post_author:"post",post_id:"post",post_content:"post",term_title:"taxonomy",term_description:"taxonomy",term_count:"taxonomy",author_name:"author",author_bio:"author",archive_title:"archive",search_query:"archive",page_number:"archive"},w=e=>{const t=e.indexOf("|");return t>-1?e.substring(0,t).trim():e.trim()},v=e=>{const t=w(e);return u[t]||"global"},h=({value:e="",onChange:l,placeholder:a="",variables:o={},variableValues:s={},context:n="post",multiline:r=!1,maxLength:c=null,label:p="",helpText:m="",id:u,disabled:h=!1,onAiClick:E=null,showAiButton:g=!0})=>{const _=(0,i.useRef)(null),b=(0,i.useRef)(null),[N,f]=(0,i.useState)(!1),[k,y]=(0,i.useState)(!1),[x,C]=(0,i.useState)(null);(0,i.useEffect)(()=>{const e=_.current,t=b.current;if(!e||!t)return;const l=()=>{t.scrollTop=e.scrollTop,t.scrollLeft=e.scrollLeft};return e.addEventListener("scroll",l),()=>e.removeEventListener("scroll",l)},[]);const P=(0,i.useMemo)(()=>{if(!e)return[];const t=[];let l=0;const a=/\{\{([^}]+)\}\}/g;let o;for(;null!==(o=a.exec(e));){o.index>l&&t.push({type:"text",content:e.slice(l,o.index)});const i=o[1].trim(),n=w(i),r=v(n),c=s[n]||s[`{{${n}}}`];t.push({type:"variable",fullTag:i,baseTag:n,raw:o[0],preview:c||n,varType:r}),l=a.lastIndex}return l<e.length&&t.push({type:"text",content:e.slice(l)}),t},[e,s]),S=e.length,M=c&&S>c,L=r?"textarea":"input";return(0,t.createElement)("div",{className:`wpseopilot-template-input ${N?"is-focused":""} ${h?"is-disabled":""}`},p&&(0,t.createElement)("div",{className:"wpseopilot-template-input__header"},(0,t.createElement)("label",{className:"wpseopilot-template-input__label",htmlFor:u},p),c&&(0,t.createElement)("span",{className:"wpseopilot-template-input__counter "+(M?"over-limit":S>0?"has-value":"")},S,"/",c)),(0,t.createElement)("div",{className:"wpseopilot-template-input__container"},(0,t.createElement)("div",{ref:b,className:"wpseopilot-template-input__highlight "+(r?"multiline":""),"aria-hidden":"true"},P.map((e,l)=>"variable"===e.type?(0,t.createElement)("span",{key:l,className:`wpseopilot-template-input__var wpseopilot-template-input__var--${e.varType}`,onMouseEnter:()=>C({...e,index:l}),onMouseLeave:()=>C(null)},(0,t.createElement)("span",{className:"wpseopilot-template-input__bracket"},"{"),(0,t.createElement)("span",{className:"wpseopilot-template-input__bracket"},"{"),(0,t.createElement)("span",{className:"wpseopilot-template-input__tag"},e.fullTag),(0,t.createElement)("span",{className:"wpseopilot-template-input__bracket"},"}"),(0,t.createElement)("span",{className:"wpseopilot-template-input__bracket"},"}"),x?.index===l&&e.preview&&(0,t.createElement)("span",{className:"wpseopilot-template-input__tooltip"},e.preview)):(0,t.createElement)("span",{key:l},e.content)),!e&&(0,t.createElement)("span",{className:"wpseopilot-template-input__placeholder"},a)),(0,t.createElement)(L,{ref:_,id:u,type:r?void 0:"text",className:"wpseopilot-template-input__field "+(r?"multiline":""),value:e,onChange:e=>l(e.target.value),onFocus:()=>f(!0),onBlur:()=>f(!1),placeholder:"",disabled:h,rows:r?3:void 0}),(0,t.createElement)("div",{className:"wpseopilot-template-input__actions"},g&&E&&(0,t.createElement)("button",{type:"button",className:"wpseopilot-template-input__action-btn wpseopilot-template-input__action-btn--ai",onClick:E,disabled:h,title:"Generate with AI"},(0,t.createElement)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},(0,t.createElement)("path",{d:"M12 3v1m0 16v1m-9-9h1m16 0h1m-2.636-6.364l-.707.707M6.343 17.657l-.707.707m12.728 0l-.707-.707M6.343 6.343l-.707-.707"}),(0,t.createElement)("circle",{cx:"12",cy:"12",r:"4"}))),(0,t.createElement)(d,{variables:o,context:n,onSelect:t=>{const a=_.current;if(!a)return void l(e+t);const o=a.selectionStart,i=a.selectionEnd,s=e.slice(0,o)+t+e.slice(i);l(s),y(!1),requestAnimationFrame(()=>{const e=o+t.length;a.setSelectionRange(e,e),a.focus()})},disabled:h,isOpen:k,onToggle:()=>y(!k),onClose:()=>y(!1),compact:!0}))),m&&(0,t.createElement)("div",{className:"wpseopilot-template-input__footer"},(0,t.createElement)("span",{className:"wpseopilot-template-input__help"},m)))},E=({isOpen:e,onClose:l,onGenerate:a,fieldType:o="title",currentValue:s="",variableValues:r={},context:c={},postTitle:p="",postContent:m="",aiProvider:d="none",aiPilot:u=null})=>{const[w,v]=(0,i.useState)(!1),[h,E]=(0,i.useState)(null),[g,_]=(0,i.useState)(!0),[b,N]=(0,i.useState)(""),[f,k]=(0,i.useState)(null),y=(0,i.useCallback)(()=>{if(!g)return"";const e=[];p&&e.push(`Post title: ${p}`),c.type&&e.push(`Content type: ${c.type}`);const t=Object.entries(r).filter(([e,t])=>t&&"string"==typeof t).map(([e,t])=>`${e.replace(/_/g," ")}: ${t}`);if(t.length>0&&e.push(...t),m){const t=m.replace(/<[^>]*>/g,"").substring(0,500);t&&e.push(`Content preview: ${t}...`)}return e.join("\n")},[g,r,c,p,m]),x=async()=>{v(!0),E(null),k(null);try{let e="";e=b?b+"\n\n"+y():y()||"Generate SEO metadata for a website.",e+="title"===o?"\n\nGenerate an SEO-optimized title (max 60 characters).":"\n\nGenerate an SEO-optimized meta description (max 155 characters).";const t=await n()({path:"/wpseopilot/v2/ai/generate",method:"POST",data:{content:e,type:o}});if(t.success&&t.data){const e="title"===o?t.data.title:t.data.description;k(e)}else E(t.message||"Failed to generate content")}catch(e){E(e.message||"An error occurred during generation")}finally{v(!1)}},C=()=>{k(null),E(null),N(""),l()};return e?"none"===d?(0,t.createElement)("div",{className:"wpseopilot-ai-modal-overlay",onClick:C},(0,t.createElement)("div",{className:"wpseopilot-ai-modal wpseopilot-ai-modal--notice",onClick:e=>e.stopPropagation()},(0,t.createElement)("div",{className:"wpseopilot-ai-modal__header"},(0,t.createElement)("h3",null,(0,t.createElement)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2"},(0,t.createElement)("circle",{cx:"12",cy:"12",r:"10"}),(0,t.createElement)("path",{d:"M12 8v4m0 4h.01"})),"AI Not Configured"),(0,t.createElement)("button",{type:"button",className:"wpseopilot-ai-modal__close",onClick:C,"aria-label":"Close"},(0,t.createElement)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2"},(0,t.createElement)("path",{d:"M18 6L6 18M6 6l12 12"})))),(0,t.createElement)("div",{className:"wpseopilot-ai-modal__body"},u?.installed?(0,t.createElement)("div",{className:"wpseopilot-ai-notice wpseopilot-ai-notice--warning"},(0,t.createElement)("div",{className:"wpseopilot-ai-notice__icon"},(0,t.createElement)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2"},(0,t.createElement)("path",{d:"M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"}))),(0,t.createElement)("div",{className:"wpseopilot-ai-notice__content"},(0,t.createElement)("h4",null,"WP AI Pilot Needs Configuration"),(0,t.createElement)("p",null,"WP AI Pilot is installed but not yet configured. Add an API key to enable AI-powered SEO suggestions."))):(0,t.createElement)("div",{className:"wpseopilot-ai-notice wpseopilot-ai-notice--info"},(0,t.createElement)("div",{className:"wpseopilot-ai-notice__icon"},(0,t.createElement)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2"},(0,t.createElement)("path",{d:"M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"}))),(0,t.createElement)("div",{className:"wpseopilot-ai-notice__content"},(0,t.createElement)("h4",null,"Enhance with WP AI Pilot"),(0,t.createElement)("p",null,"Install WP AI Pilot to unlock AI-powered title and meta description generation.")))),(0,t.createElement)("div",{className:"wpseopilot-ai-modal__footer"},(0,t.createElement)("button",{type:"button",className:"wpseopilot-ai-modal__btn wpseopilot-ai-modal__btn--secondary",onClick:C},"Cancel"),u?.installed?(0,t.createElement)("a",{href:u.settingsUrl,className:"wpseopilot-ai-modal__btn wpseopilot-ai-modal__btn--primary"},"Configure WP AI Pilot"):(0,t.createElement)("a",{href:"/wp-admin/plugin-install.php?s=wp+ai+pilot&tab=search",className:"wpseopilot-ai-modal__btn wpseopilot-ai-modal__btn--primary"},"Install WP AI Pilot")))):(0,t.createElement)("div",{className:"wpseopilot-ai-modal-overlay",onClick:C},(0,t.createElement)("div",{className:"wpseopilot-ai-modal",onClick:e=>e.stopPropagation()},(0,t.createElement)("div",{className:"wpseopilot-ai-modal__header"},(0,t.createElement)("h3",null,(0,t.createElement)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2"},(0,t.createElement)("path",{d:"M12 3v1m0 16v1m-9-9h1m16 0h1m-2.636-6.364l-.707.707M6.343 17.657l-.707.707m12.728 0l-.707-.707M6.343 6.343l-.707-.707"}),(0,t.createElement)("circle",{cx:"12",cy:"12",r:"4"})),"Generate ","title"===o?"Title":"Description"),"wp-ai-pilot"===d&&(0,t.createElement)("span",{className:"wpseopilot-ai-badge"},(0,t.createElement)("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2"},(0,t.createElement)("path",{d:"M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"})),"WP AI Pilot"),(0,t.createElement)("button",{type:"button",className:"wpseopilot-ai-modal__close",onClick:C,"aria-label":"Close"},(0,t.createElement)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2"},(0,t.createElement)("path",{d:"M18 6L6 18M6 6l12 12"})))),(0,t.createElement)("div",{className:"wpseopilot-ai-modal__body"},(0,t.createElement)("div",{className:"wpseopilot-ai-modal__option"},(0,t.createElement)("label",{className:"wpseopilot-ai-modal__checkbox"},(0,t.createElement)("input",{type:"checkbox",checked:g,onChange:e=>_(e.target.checked)}),(0,t.createElement)("span",{className:"wpseopilot-ai-modal__checkbox-label"},"Include post content as context"))),g&&p&&(0,t.createElement)("div",{className:"wpseopilot-ai-modal__context-preview"},(0,t.createElement)("div",{className:"wpseopilot-ai-modal__context-item"},(0,t.createElement)("span",{className:"wpseopilot-ai-modal__context-key"},"Post:"),(0,t.createElement)("span",{className:"wpseopilot-ai-modal__context-value"},p))),(0,t.createElement)("div",{className:"wpseopilot-ai-modal__field"},(0,t.createElement)("label",{htmlFor:"ai-custom-prompt"},"Custom instructions (optional)"),(0,t.createElement)("textarea",{id:"ai-custom-prompt",value:b,onChange:e=>N(e.target.value),placeholder:`e.g., "Focus on ${"title"===o?"including keywords":"highlighting benefits"}"`,rows:2})),h&&(0,t.createElement)("div",{className:"wpseopilot-ai-modal__error"},(0,t.createElement)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2"},(0,t.createElement)("circle",{cx:"12",cy:"12",r:"10"}),(0,t.createElement)("path",{d:"M12 8v4m0 4h.01"})),h),f&&(0,t.createElement)("div",{className:"wpseopilot-ai-modal__result"},(0,t.createElement)("label",null,"Generated ","title"===o?"title":"description",":"),(0,t.createElement)("div",{className:"wpseopilot-ai-modal__result-box"},(0,t.createElement)("p",null,f),(0,t.createElement)("span",{className:"wpseopilot-ai-modal__char-count"},f.length," characters")))),(0,t.createElement)("div",{className:"wpseopilot-ai-modal__footer"},(0,t.createElement)("button",{type:"button",className:"wpseopilot-ai-modal__btn wpseopilot-ai-modal__btn--secondary",onClick:C},"Cancel"),f?(0,t.createElement)(t.Fragment,null,(0,t.createElement)("button",{type:"button",className:"wpseopilot-ai-modal__btn",onClick:x,disabled:w},"Regenerate"),(0,t.createElement)("button",{type:"button",className:"wpseopilot-ai-modal__btn wpseopilot-ai-modal__btn--primary",onClick:()=>{f&&(a(f),C())}},"Apply")):(0,t.createElement)("button",{type:"button",className:"wpseopilot-ai-modal__btn wpseopilot-ai-modal__btn--primary",onClick:x,disabled:w},w?(0,t.createElement)(t.Fragment,null,(0,t.createElement)("span",{className:"wpseopilot-ai-modal__spinner"}),"Generating..."):(0,t.createElement)(t.Fragment,null,(0,t.createElement)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2"},(0,t.createElement)("path",{d:"M12 3v1m0 16v1m-9-9h1m16 0h1m-2.636-6.364l-.707.707M6.343 17.657l-.707.707m12.728 0l-.707-.707M6.343 6.343l-.707-.707"}),(0,t.createElement)("circle",{cx:"12",cy:"12",r:"4"})),"Generate"))))):null},g=({seoMeta:e,updateMeta:l,seoScore:a,effectiveTitle:o,effectiveDescription:s,postUrl:n,postTitle:p,postContent:d,featuredImage:u,hasChanges:w,variables:v,variableValues:g,aiEnabled:_,aiProvider:b="none",aiPilot:N=null})=>{const[f,k]=(0,i.useState)("general"),[y,x]=(0,i.useState)({isOpen:!1,fieldType:"title",onApply:null}),C=((e.title||"").length,(e.description||"").length,(0,i.useCallback)((e,t)=>{x({isOpen:!0,fieldType:e,onApply:t})},[])),P=(0,i.useCallback)(()=>{x({isOpen:!1,fieldType:"title",onApply:null})},[]),S=(0,i.useCallback)(e=>{y.onApply&&e&&y.onApply(e),P()},[y,P]);return(0,t.createElement)("div",{className:"wpseopilot-editor-panel"},(0,t.createElement)("div",{className:"wpseopilot-score-header"},(0,t.createElement)(m,{score:a?.score||0,level:a?.level||"poor"}),(0,t.createElement)("div",{className:"wpseopilot-score-info"},(0,t.createElement)("div",{className:"wpseopilot-score-label"},"SEO Score"),(0,t.createElement)("div",{className:"wpseopilot-score-status"},a?.issues?.length>0?`${a.issues.length} issue${1!==a.issues.length?"s":""} found`:"Looking good!"))),(0,t.createElement)("div",{className:"wpseopilot-tabs"},(0,t.createElement)("button",{type:"button",className:"wpseopilot-tab "+("general"===f?"active":""),onClick:()=>k("general")},"General"),(0,t.createElement)("button",{type:"button",className:"wpseopilot-tab "+("advanced"===f?"active":""),onClick:()=>k("advanced")},"Advanced"),(0,t.createElement)("button",{type:"button",className:"wpseopilot-tab "+("social"===f?"active":""),onClick:()=>k("social")},"Social")),"general"===f&&(0,t.createElement)("div",{className:"wpseopilot-tab-content"},(0,t.createElement)("div",{className:"wpseopilot-preview-section"},(0,t.createElement)("label",{className:"wpseopilot-section-label"},"Search Preview"),(0,t.createElement)(c,{title:o,description:s,url:n})),(0,t.createElement)("div",{className:"wpseopilot-field wpseopilot-field--keyphrase"},(0,t.createElement)("div",{className:"wpseopilot-field-header"},(0,t.createElement)("label",null,"Focus Keyphrase")),(0,t.createElement)("input",{type:"text",className:"wpseopilot-field-input",value:e.focus_keyphrase||"",onChange:e=>l("focus_keyphrase",e.target.value),placeholder:"Enter your target keyword"}),(0,t.createElement)("p",{className:"wpseopilot-field-help"},"The main keyword you want this page to rank for")),(0,t.createElement)(h,{label:"SEO Title",id:"wpseopilot-seo-title",value:e.title||"",onChange:e=>l("title",e),placeholder:p||"Enter SEO title",maxLength:60,variables:v,variableValues:g,context:"post",showAiButton:_,onAiClick:_?()=>C("title",e=>l("title",e)):null}),(0,t.createElement)(h,{label:"Meta Description",id:"wpseopilot-meta-desc",value:e.description||"",onChange:e=>l("description",e),placeholder:"Enter meta description",maxLength:160,multiline:!0,variables:v,variableValues:g,context:"post",showAiButton:_,onAiClick:_?()=>C("description",e=>l("description",e)):null}),a?.issues?.length>0&&(0,t.createElement)("div",{className:"wpseopilot-issues"},(0,t.createElement)("label",{className:"wpseopilot-section-label"},"Analysis"),(0,t.createElement)("ul",{className:"wpseopilot-issues-list"},a.issues.slice(0,5).map((e,l)=>(0,t.createElement)("li",{key:l,className:`wpseopilot-issue wpseopilot-issue--${e.severity||"warning"}`},(0,t.createElement)("span",{className:"wpseopilot-issue-icon"},"error"===e.severity?"!":"?"),(0,t.createElement)("span",{className:"wpseopilot-issue-text"},e.message)))))),"advanced"===f&&(0,t.createElement)("div",{className:"wpseopilot-tab-content"},(0,t.createElement)("div",{className:"wpseopilot-field"},(0,t.createElement)("div",{className:"wpseopilot-field-header"},(0,t.createElement)("label",null,"Canonical URL")),(0,t.createElement)("input",{type:"url",className:"wpseopilot-field-input",value:e.canonical||"",onChange:e=>l("canonical",e.target.value),placeholder:n}),(0,t.createElement)("p",{className:"wpseopilot-field-help"},"Leave empty to use the default URL")),(0,t.createElement)("div",{className:"wpseopilot-robots-section"},(0,t.createElement)("label",{className:"wpseopilot-section-label"},"Search Engine Visibility"),(0,t.createElement)("label",{className:"wpseopilot-toggle"},(0,t.createElement)("input",{type:"checkbox",checked:e.noindex||!1,onChange:e=>l("noindex",e.target.checked)}),(0,t.createElement)("span",{className:"wpseopilot-toggle-slider"}),(0,t.createElement)("span",{className:"wpseopilot-toggle-label"},"Hide from search results",(0,t.createElement)("small",null,"Add noindex meta tag"))),(0,t.createElement)("label",{className:"wpseopilot-toggle"},(0,t.createElement)("input",{type:"checkbox",checked:e.nofollow||!1,onChange:e=>l("nofollow",e.target.checked)}),(0,t.createElement)("span",{className:"wpseopilot-toggle-slider"}),(0,t.createElement)("span",{className:"wpseopilot-toggle-label"},"Don't follow links",(0,t.createElement)("small",null,"Add nofollow meta tag")))),(0,t.createElement)("div",{className:"wpseopilot-robots-preview"},(0,t.createElement)("label",{className:"wpseopilot-section-label"},"Robots Meta"),(0,t.createElement)("code",{className:"wpseopilot-robots-code"},e.noindex||e.nofollow?`${e.noindex?"noindex":"index"}, ${e.nofollow?"nofollow":"follow"}`:"index, follow (default)"))),"social"===f&&(0,t.createElement)("div",{className:"wpseopilot-tab-content"},(0,t.createElement)("div",{className:"wpseopilot-social-preview"},(0,t.createElement)("label",{className:"wpseopilot-section-label"},"Social Preview"),(0,t.createElement)("div",{className:"wpseopilot-social-card"},(0,t.createElement)("div",{className:"wpseopilot-social-image"},e.og_image||u?(0,t.createElement)("img",{src:e.og_image||u,alt:""}):(0,t.createElement)("div",{className:"wpseopilot-social-placeholder"},(0,t.createElement)("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none"},(0,t.createElement)("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",stroke:"currentColor",strokeWidth:"2"}),(0,t.createElement)("circle",{cx:"8.5",cy:"8.5",r:"1.5",fill:"currentColor"}),(0,t.createElement)("path",{d:"M21 15l-5-5L5 21",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})),(0,t.createElement)("span",null,"No image set"))),(0,t.createElement)("div",{className:"wpseopilot-social-content"},(0,t.createElement)("div",{className:"wpseopilot-social-url"},new URL(n).hostname),(0,t.createElement)("div",{className:"wpseopilot-social-title"},o),(0,t.createElement)("div",{className:"wpseopilot-social-desc"},s||"No description available")))),(0,t.createElement)("div",{className:"wpseopilot-field"},(0,t.createElement)("div",{className:"wpseopilot-field-header"},(0,t.createElement)("label",null,"Social Image URL")),(0,t.createElement)("input",{type:"url",className:"wpseopilot-field-input",value:e.og_image||"",onChange:e=>l("og_image",e.target.value),placeholder:"https://..."}),(0,t.createElement)("p",{className:"wpseopilot-field-help"},"1200x630 recommended. Leave empty to use featured image."),!e.og_image&&u&&(0,t.createElement)("p",{className:"wpseopilot-field-note"},"Using featured image as fallback")),(0,t.createElement)(r.Button,{variant:"secondary",className:"wpseopilot-media-button",onClick:()=>{const e=wp.media({title:"Select Social Image",button:{text:"Use Image"},multiple:!1});e.on("select",()=>{const t=e.state().get("selection").first().toJSON();l("og_image",t.url)}),e.open()}},(0,t.createElement)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",style:{marginRight:"6px"}},(0,t.createElement)("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",stroke:"currentColor",strokeWidth:"2"}),(0,t.createElement)("circle",{cx:"8.5",cy:"8.5",r:"1.5",fill:"currentColor"}),(0,t.createElement)("path",{d:"M21 15l-5-5L5 21",stroke:"currentColor",strokeWidth:"2"})),"Select Image")),(0,t.createElement)(E,{isOpen:y.isOpen,onClose:P,onGenerate:S,fieldType:y.fieldType,currentValue:"title"===y.fieldType?e.title:e.description,postTitle:p,postContent:d,variableValues:g,aiProvider:b,aiPilot:N}))},_=()=>(0,t.createElement)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,t.createElement)("path",{d:"M21 16v-2l-8-5V3.5c0-.83-.67-1.5-1.5-1.5S10 2.67 10 3.5V9l-8 5v2l8-2.5V19l-2 1.5V22l3.5-1 3.5 1v-1.5L13 19v-5.5l8 2.5z",fill:"currentColor"})),b=window.wpseopilotEditor||{},N=b.variables||{},f=b.aiEnabled||!1,k=b.aiProvider||"none",y=b.aiPilot||null;(0,l.registerPlugin)("wpseopilot",{render:()=>{const[e,l]=(0,i.useState)({title:"",description:"",canonical:"",noindex:!1,nofollow:!1,og_image:"",focus_keyphrase:""}),[s,r]=(0,i.useState)(null),[c,p]=(0,i.useState)(!1),[m,d]=(0,i.useState)(!1),[u,w]=(0,i.useState)({}),{postId:v,postTitle:h,postExcerpt:E,postContent:x,postType:C,postSlug:P,featuredImage:S}=(0,o.useSelect)(e=>{const t=e("core/editor"),l=t.getCurrentPost(),a=t.getEditedPostAttribute("featured_media");let o="";if(a){const t=e("core").getMedia(a);t&&(o=t.source_url)}return{postId:t.getCurrentPostId(),postTitle:t.getEditedPostAttribute("title")||"",postExcerpt:t.getEditedPostAttribute("excerpt")||"",postContent:t.getEditedPostContent()||"",postType:t.getCurrentPostType(),postSlug:l?.slug||"",featuredImage:o}},[]),{editPost:M}=(0,o.useDispatch)("core/editor");(0,i.useEffect)(()=>{if(!v||!C)return;const e={post:"posts",page:"pages",attachment:"media"}[t=C]||t;var t;n()({path:`/wp/v2/${e}/${v}`}).then(e=>{if(e.meta&&e.meta._wpseopilot_meta){const t=e.meta._wpseopilot_meta;l({title:t.title||"",description:t.description||"",canonical:t.canonical||"",noindex:"1"===t.noindex,nofollow:"1"===t.nofollow,og_image:t.og_image||"",focus_keyphrase:t.focus_keyphrase||""})}}).catch(()=>{})},[v,C]),(0,i.useEffect)(()=>{if(!v)return;const e=setTimeout(()=>{n()({path:`/wpseopilot/v2/audit/post/${v}`}).then(e=>{e.success&&e.data&&r(e.data)}).catch(()=>{})},500);return()=>clearTimeout(e)},[v,e,h,x]),(0,i.useEffect)(()=>{const e={post_title:h||"",post_excerpt:E||"",site_title:b.siteTitle||"",tagline:b.tagline||"",separator:b.separator||"-",current_year:(new Date).getFullYear().toString()};w(e)},[h,E]);const L=(0,i.useCallback)((t,a)=>{l(e=>({...e,[t]:a})),d(!0);const o={...e,[t]:a},i={title:o.title,description:o.description,canonical:o.canonical,noindex:o.noindex?"1":"",nofollow:o.nofollow?"1":"",og_image:o.og_image,focus_keyphrase:o.focus_keyphrase};M({meta:{_wpseopilot_meta:i}})},[e,M]),A=e.title||h||"Untitled",T=e.description||E||"",I=window.location.origin,O=P?`${I}/${P}/`:I;return(0,t.createElement)(t.Fragment,null,(0,t.createElement)(a.PluginSidebarMoreMenuItem,{target:"wpseopilot-sidebar",icon:(0,t.createElement)(_,null)},"WP SEO Pilot"),(0,t.createElement)(a.PluginSidebar,{name:"wpseopilot-sidebar",title:"WP SEO Pilot",icon:(0,t.createElement)(_,null)},(0,t.createElement)(g,{seoMeta:e,updateMeta:L,seoScore:s,effectiveTitle:A,effectiveDescription:T,postUrl:O,postTitle:h,postContent:x,featuredImage:S,hasChanges:m,variables:N,variableValues:u,aiEnabled:f,aiProvider:k,aiPilot:y})))},icon:(0,t.createElement)(_,null)})})();