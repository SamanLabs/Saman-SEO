(()=>{"use strict";var e={n:t=>{var a=t&&t.__esModule?()=>t.default:()=>t;return e.d(a,{a}),a},d:(t,a)=>{for(var l in a)e.o(a,l)&&!e.o(t,l)&&Object.defineProperty(t,l,{enumerable:!0,get:a[l]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.React,a=window.wp.plugins,l=window.wp.editPost,o=window.wp.data,s=window.wp.element,i=window.wp.apiFetch;var n=e.n(i);const r=window.wp.components,c=({title:e,description:a,url:l})=>{const o=e.length>60?e.substring(0,57)+"...":e,s=a.length>160?a.substring(0,157)+"...":a||"No description provided. Add a meta description to control what appears here.";return(0,t.createElement)("div",{className:"wpseopilot-search-preview"},(0,t.createElement)("div",{className:"wpseopilot-search-preview__breadcrumb"},(0,t.createElement)("div",{className:"wpseopilot-search-preview__favicon"},(0,t.createElement)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none"},(0,t.createElement)("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2"}),(0,t.createElement)("path",{d:"M12 6v6l4 2",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}))),(0,t.createElement)("div",{className:"wpseopilot-search-preview__url-container"},(0,t.createElement)("span",{className:"wpseopilot-search-preview__site-name"},(()=>{try{return new URL(l).hostname.replace("www.","")}catch{return"example.com"}})()),(0,t.createElement)("span",{className:"wpseopilot-search-preview__url"},(e=>{try{const t=new URL(e),a="/"===t.pathname?"":t.pathname;return`${t.hostname}${a}`}catch{return e}})(l))),(0,t.createElement)("button",{type:"button",className:"wpseopilot-search-preview__menu","aria-label":"More options"},(0,t.createElement)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none"},(0,t.createElement)("circle",{cx:"12",cy:"5",r:"1.5",fill:"currentColor"}),(0,t.createElement)("circle",{cx:"12",cy:"12",r:"1.5",fill:"currentColor"}),(0,t.createElement)("circle",{cx:"12",cy:"19",r:"1.5",fill:"currentColor"})))),(0,t.createElement)("h3",{className:"wpseopilot-search-preview__title"},o||"Page Title"),(0,t.createElement)("p",{className:"wpseopilot-search-preview__description"},s))},p={excellent:"#00a32a",good:"#00a32a",fair:"#dba617",poor:"#d63638"},m=({score:e=0,level:a="poor"})=>{const l=p[a]||p.poor,o=2*Math.PI*20,s=o-e/100*o;return(0,t.createElement)("div",{className:"wpseopilot-gauge"},(0,t.createElement)("svg",{viewBox:"0 0 48 48",className:"wpseopilot-gauge__svg"},(0,t.createElement)("circle",{className:"wpseopilot-gauge__bg",cx:"24",cy:"24",r:"20",fill:"none",strokeWidth:"4"}),(0,t.createElement)("circle",{className:"wpseopilot-gauge__progress",cx:"24",cy:"24",r:"20",fill:"none",strokeWidth:"4",strokeDasharray:o,strokeDashoffset:s,strokeLinecap:"round",style:{stroke:l}})),(0,t.createElement)("div",{className:"wpseopilot-gauge__value",style:{color:l}},e))},d=({variables:e={},onSelect:a,context:l="post",buttonLabel:o="Variables",disabled:i=!1,compact:n=!1,isOpen:r,onToggle:c,onClose:p})=>{const[m,d]=(0,s.useState)(!1),[u,w]=(0,s.useState)(""),v=(0,s.useRef)(null),h=void 0!==r?r:m,g=e=>{void 0!==r?e?c?.():p?.():d(e)};(0,s.useEffect)(()=>{const e=e=>{v.current&&!v.current.contains(e.target)&&g(!1)};return h&&document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[h,r]);const E=e=>{a&&a(`{{${e.tag}}}`),g(!1),w("")},b=()=>{void 0!==r?c?.():d(!m)},_=h?(()=>{const t={},a={global:["global"],post:["global","post"],taxonomy:["global","taxonomy"],archive:["global","archive","author"],author:["global","author"],date:["global","archive"],search:["global"],404:["global"]}[l]||["global","post"];return Object.entries(e).forEach(([e,l])=>{if(!a.includes(e))return;const o=(l.vars||[]).filter(e=>{if(!u)return!0;const t=u.toLowerCase();return e.tag.toLowerCase().includes(t)||e.label.toLowerCase().includes(t)||e.desc&&e.desc.toLowerCase().includes(t)});o.length>0&&(t[e]={...l,vars:o})}),t})():{};return n?(0,t.createElement)("div",{className:"wpseopilot-variable-picker wpseopilot-variable-picker--compact",ref:v},(0,t.createElement)("button",{type:"button",className:"wpseopilot-template-input__action-btn wpseopilot-template-input__action-btn--vars",onClick:b,disabled:i,title:"Insert variable"},(0,t.createElement)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},(0,t.createElement)("path",{d:"M4 7h3a1 1 0 0 0 1-1V3"}),(0,t.createElement)("path",{d:"M20 7h-3a1 1 0 0 1-1-1V3"}),(0,t.createElement)("path",{d:"M4 17h3a1 1 0 0 1 1 1v3"}),(0,t.createElement)("path",{d:"M20 17h-3a1 1 0 0 0-1 1v3"}),(0,t.createElement)("path",{d:"M9 12h6"}),(0,t.createElement)("path",{d:"M12 9v6"}))),h&&(0,t.createElement)("div",{className:"wpseopilot-variable-picker__dropdown"},(0,t.createElement)("div",{className:"wpseopilot-variable-picker__search"},(0,t.createElement)("input",{type:"text",placeholder:"Search variables...",value:u,onChange:e=>w(e.target.value),autoFocus:!0})),(0,t.createElement)("div",{className:"wpseopilot-variable-picker__groups"},Object.entries(_).map(([e,a])=>(0,t.createElement)("div",{key:e,className:"wpseopilot-variable-picker__group"},(0,t.createElement)("div",{className:`wpseopilot-variable-picker__group-label wpseopilot-variable-picker__group-label--${e}`},a.label),(0,t.createElement)("div",{className:"wpseopilot-variable-picker__items"},a.vars.map(a=>(0,t.createElement)("button",{key:a.tag,type:"button",className:"wpseopilot-variable-picker__item",onClick:()=>E(a)},(0,t.createElement)("div",{className:"wpseopilot-variable-picker__item-header"},(0,t.createElement)("code",{className:`wpseopilot-variable-picker__tag wpseopilot-variable-picker__tag--${e}`},a.tag),(0,t.createElement)("span",{className:"wpseopilot-variable-picker__label"},a.label)),a.preview&&(0,t.createElement)("div",{className:"wpseopilot-variable-picker__preview"},a.preview)))))),0===Object.keys(_).length&&(0,t.createElement)("div",{className:"wpseopilot-variable-picker__empty"},"No variables found")))):(0,t.createElement)("div",{className:"wpseopilot-variable-picker",ref:v},(0,t.createElement)("button",{type:"button",className:"wpseopilot-variable-picker__trigger",onClick:b,disabled:i,title:"Insert variable"},(0,t.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",width:"16",height:"16"},(0,t.createElement)("path",{fillRule:"evenodd",d:"M4.5 2A2.5 2.5 0 002 4.5v3.879a2.5 2.5 0 00.732 1.767l7.5 7.5a2.5 2.5 0 003.536 0l3.878-3.878a2.5 2.5 0 000-3.536l-7.5-7.5A2.5 2.5 0 008.38 2H4.5zM5 6a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),(0,t.createElement)("span",null,o)),h&&(0,t.createElement)("div",{className:"wpseopilot-variable-picker__dropdown"},(0,t.createElement)("div",{className:"wpseopilot-variable-picker__search"},(0,t.createElement)("input",{type:"text",placeholder:"Search variables...",value:u,onChange:e=>w(e.target.value),autoFocus:!0})),(0,t.createElement)("div",{className:"wpseopilot-variable-picker__groups"},Object.entries(_).map(([e,a])=>(0,t.createElement)("div",{key:e,className:"wpseopilot-variable-picker__group"},(0,t.createElement)("div",{className:`wpseopilot-variable-picker__group-label wpseopilot-variable-picker__group-label--${e}`},a.label),(0,t.createElement)("div",{className:"wpseopilot-variable-picker__items"},a.vars.map(a=>(0,t.createElement)("button",{key:a.tag,type:"button",className:"wpseopilot-variable-picker__item",onClick:()=>E(a)},(0,t.createElement)("div",{className:"wpseopilot-variable-picker__item-header"},(0,t.createElement)("code",{className:`wpseopilot-variable-picker__tag wpseopilot-variable-picker__tag--${e}`},a.tag),(0,t.createElement)("span",{className:"wpseopilot-variable-picker__label"},a.label)),a.preview&&(0,t.createElement)("div",{className:"wpseopilot-variable-picker__preview"},a.preview)))))),0===Object.keys(_).length&&(0,t.createElement)("div",{className:"wpseopilot-variable-picker__empty"},"No variables found"))))},u={site_title:"global",tagline:"global",site_url:"global",separator:"separator",current_year:"global",current_month:"global",current_day:"global",post_title:"post",post_excerpt:"post",post_date:"post",post_modified:"post",post_author:"post",post_id:"post",post_content:"post",term_title:"taxonomy",term_description:"taxonomy",term_count:"taxonomy",author_name:"author",author_bio:"author",archive_title:"archive",search_query:"archive",page_number:"archive"},w=e=>{const t=e.indexOf("|");return t>-1?e.substring(0,t).trim():e.trim()},v=e=>{const t=w(e);return u[t]||"global"},h=({value:e="",onChange:a,placeholder:l="",variables:o={},variableValues:i={},context:n="post",multiline:r=!1,maxLength:c=null,label:p="",helpText:m="",id:u,disabled:h=!1,onAiClick:g=null,showAiButton:E=!0})=>{const b=(0,s.useRef)(null),_=(0,s.useRef)(null),[f,N]=(0,s.useState)(!1),[k,y]=(0,s.useState)(!1),[x,C]=(0,s.useState)(null);(0,s.useEffect)(()=>{const e=b.current,t=_.current;if(!e||!t)return;const a=()=>{t.scrollTop=e.scrollTop,t.scrollLeft=e.scrollLeft};return e.addEventListener("scroll",a),()=>e.removeEventListener("scroll",a)},[]);const S=(0,s.useMemo)(()=>{if(!e)return[];const t=[];let a=0;const l=/\{\{([^}]+)\}\}/g;let o;for(;null!==(o=l.exec(e));){o.index>a&&t.push({type:"text",content:e.slice(a,o.index)});const s=o[1].trim(),n=w(s),r=v(n),c=i[n]||i[`{{${n}}}`];t.push({type:"variable",fullTag:s,baseTag:n,raw:o[0],preview:c||n,varType:r}),a=l.lastIndex}return a<e.length&&t.push({type:"text",content:e.slice(a)}),t},[e,i]),M=e.length,L=c&&M>c,T=r?"textarea":"input";return(0,t.createElement)("div",{className:`wpseopilot-template-input ${f?"is-focused":""} ${h?"is-disabled":""}`},p&&(0,t.createElement)("div",{className:"wpseopilot-template-input__header"},(0,t.createElement)("label",{className:"wpseopilot-template-input__label",htmlFor:u},p),c&&(0,t.createElement)("span",{className:"wpseopilot-template-input__counter "+(L?"over-limit":M>0?"has-value":"")},M,"/",c)),(0,t.createElement)("div",{className:"wpseopilot-template-input__container"},(0,t.createElement)("div",{ref:_,className:"wpseopilot-template-input__highlight "+(r?"multiline":""),"aria-hidden":"true"},S.map((e,a)=>"variable"===e.type?(0,t.createElement)("span",{key:a,className:`wpseopilot-template-input__var wpseopilot-template-input__var--${e.varType}`,onMouseEnter:()=>C({...e,index:a}),onMouseLeave:()=>C(null)},(0,t.createElement)("span",{className:"wpseopilot-template-input__bracket"},"{"),(0,t.createElement)("span",{className:"wpseopilot-template-input__bracket"},"{"),(0,t.createElement)("span",{className:"wpseopilot-template-input__tag"},e.fullTag),(0,t.createElement)("span",{className:"wpseopilot-template-input__bracket"},"}"),(0,t.createElement)("span",{className:"wpseopilot-template-input__bracket"},"}"),x?.index===a&&e.preview&&(0,t.createElement)("span",{className:"wpseopilot-template-input__tooltip"},e.preview)):(0,t.createElement)("span",{key:a},e.content)),!e&&(0,t.createElement)("span",{className:"wpseopilot-template-input__placeholder"},l)),(0,t.createElement)(T,{ref:b,id:u,type:r?void 0:"text",className:"wpseopilot-template-input__field "+(r?"multiline":""),value:e,onChange:e=>a(e.target.value),onFocus:()=>N(!0),onBlur:()=>N(!1),placeholder:"",disabled:h,rows:r?3:void 0}),(0,t.createElement)("div",{className:"wpseopilot-template-input__actions"},E&&g&&(0,t.createElement)("button",{type:"button",className:"wpseopilot-template-input__action-btn wpseopilot-template-input__action-btn--ai",onClick:g,disabled:h,title:"Generate with AI"},(0,t.createElement)("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},(0,t.createElement)("path",{d:"M12 3v1m0 16v1m-9-9h1m16 0h1m-2.636-6.364l-.707.707M6.343 17.657l-.707.707m12.728 0l-.707-.707M6.343 6.343l-.707-.707"}),(0,t.createElement)("circle",{cx:"12",cy:"12",r:"4"}))),(0,t.createElement)(d,{variables:o,context:n,onSelect:t=>{const l=b.current;if(!l)return void a(e+t);const o=l.selectionStart,s=l.selectionEnd,i=e.slice(0,o)+t+e.slice(s);a(i),y(!1),requestAnimationFrame(()=>{const e=o+t.length;l.setSelectionRange(e,e),l.focus()})},disabled:h,isOpen:k,onToggle:()=>y(!k),onClose:()=>y(!1),compact:!0}))),m&&(0,t.createElement)("div",{className:"wpseopilot-template-input__footer"},(0,t.createElement)("span",{className:"wpseopilot-template-input__help"},m)))},g=({isOpen:e,onClose:a,onGenerate:l,fieldType:o="title",currentValue:i="",variableValues:r={},context:c={},postTitle:p="",postContent:m=""})=>{const[d,u]=(0,s.useState)(!1),[w,v]=(0,s.useState)(null),[h,g]=(0,s.useState)(!0),[E,b]=(0,s.useState)(""),[_,f]=(0,s.useState)(null),N=(0,s.useCallback)(()=>{if(!h)return"";const e=[];p&&e.push(`Post title: ${p}`),c.type&&e.push(`Content type: ${c.type}`);const t=Object.entries(r).filter(([e,t])=>t&&"string"==typeof t).map(([e,t])=>`${e.replace(/_/g," ")}: ${t}`);if(t.length>0&&e.push(...t),m){const t=m.replace(/<[^>]*>/g,"").substring(0,500);t&&e.push(`Content preview: ${t}...`)}return e.join("\n")},[h,r,c,p,m]),k=async()=>{u(!0),v(null),f(null);try{let e="";e=E?E+"\n\n"+N():N()||"Generate SEO metadata for a website.",e+="title"===o?"\n\nGenerate an SEO-optimized title (max 60 characters).":"\n\nGenerate an SEO-optimized meta description (max 155 characters).";const t=await n()({path:"/wpseopilot/v2/ai/generate",method:"POST",data:{content:e,type:o}});if(t.success&&t.data){const e="title"===o?t.data.title:t.data.description;f(e)}else v(t.message||"Failed to generate content")}catch(e){v(e.message||"An error occurred during generation")}finally{u(!1)}},y=()=>{f(null),v(null),b(""),a()};return e?(0,t.createElement)("div",{className:"wpseopilot-ai-modal-overlay",onClick:y},(0,t.createElement)("div",{className:"wpseopilot-ai-modal",onClick:e=>e.stopPropagation()},(0,t.createElement)("div",{className:"wpseopilot-ai-modal__header"},(0,t.createElement)("h3",null,(0,t.createElement)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2"},(0,t.createElement)("path",{d:"M12 3v1m0 16v1m-9-9h1m16 0h1m-2.636-6.364l-.707.707M6.343 17.657l-.707.707m12.728 0l-.707-.707M6.343 6.343l-.707-.707"}),(0,t.createElement)("circle",{cx:"12",cy:"12",r:"4"})),"Generate ","title"===o?"Title":"Description"),(0,t.createElement)("button",{type:"button",className:"wpseopilot-ai-modal__close",onClick:y,"aria-label":"Close"},(0,t.createElement)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2"},(0,t.createElement)("path",{d:"M18 6L6 18M6 6l12 12"})))),(0,t.createElement)("div",{className:"wpseopilot-ai-modal__body"},(0,t.createElement)("div",{className:"wpseopilot-ai-modal__option"},(0,t.createElement)("label",{className:"wpseopilot-ai-modal__checkbox"},(0,t.createElement)("input",{type:"checkbox",checked:h,onChange:e=>g(e.target.checked)}),(0,t.createElement)("span",{className:"wpseopilot-ai-modal__checkbox-label"},"Include post content as context"))),h&&p&&(0,t.createElement)("div",{className:"wpseopilot-ai-modal__context-preview"},(0,t.createElement)("div",{className:"wpseopilot-ai-modal__context-item"},(0,t.createElement)("span",{className:"wpseopilot-ai-modal__context-key"},"Post:"),(0,t.createElement)("span",{className:"wpseopilot-ai-modal__context-value"},p))),(0,t.createElement)("div",{className:"wpseopilot-ai-modal__field"},(0,t.createElement)("label",{htmlFor:"ai-custom-prompt"},"Custom instructions (optional)"),(0,t.createElement)("textarea",{id:"ai-custom-prompt",value:E,onChange:e=>b(e.target.value),placeholder:`e.g., "Focus on ${"title"===o?"including keywords":"highlighting benefits"}"`,rows:2})),w&&(0,t.createElement)("div",{className:"wpseopilot-ai-modal__error"},(0,t.createElement)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2"},(0,t.createElement)("circle",{cx:"12",cy:"12",r:"10"}),(0,t.createElement)("path",{d:"M12 8v4m0 4h.01"})),w),_&&(0,t.createElement)("div",{className:"wpseopilot-ai-modal__result"},(0,t.createElement)("label",null,"Generated ","title"===o?"title":"description",":"),(0,t.createElement)("div",{className:"wpseopilot-ai-modal__result-box"},(0,t.createElement)("p",null,_),(0,t.createElement)("span",{className:"wpseopilot-ai-modal__char-count"},_.length," characters")))),(0,t.createElement)("div",{className:"wpseopilot-ai-modal__footer"},(0,t.createElement)("button",{type:"button",className:"wpseopilot-ai-modal__btn wpseopilot-ai-modal__btn--secondary",onClick:y},"Cancel"),_?(0,t.createElement)(t.Fragment,null,(0,t.createElement)("button",{type:"button",className:"wpseopilot-ai-modal__btn",onClick:k,disabled:d},"Regenerate"),(0,t.createElement)("button",{type:"button",className:"wpseopilot-ai-modal__btn wpseopilot-ai-modal__btn--primary",onClick:()=>{_&&(l(_),y())}},"Apply")):(0,t.createElement)("button",{type:"button",className:"wpseopilot-ai-modal__btn wpseopilot-ai-modal__btn--primary",onClick:k,disabled:d},d?(0,t.createElement)(t.Fragment,null,(0,t.createElement)("span",{className:"wpseopilot-ai-modal__spinner"}),"Generating..."):(0,t.createElement)(t.Fragment,null,(0,t.createElement)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2"},(0,t.createElement)("path",{d:"M12 3v1m0 16v1m-9-9h1m16 0h1m-2.636-6.364l-.707.707M6.343 17.657l-.707.707m12.728 0l-.707-.707M6.343 6.343l-.707-.707"}),(0,t.createElement)("circle",{cx:"12",cy:"12",r:"4"})),"Generate"))))):null},E=({seoMeta:e,updateMeta:a,seoScore:l,effectiveTitle:o,effectiveDescription:i,postUrl:n,postTitle:p,postContent:d,featuredImage:u,hasChanges:w,variables:v,variableValues:E,aiEnabled:b})=>{const[_,f]=(0,s.useState)("general"),[N,k]=(0,s.useState)({isOpen:!1,fieldType:"title",onApply:null}),y=((e.title||"").length,(e.description||"").length,(0,s.useCallback)((e,t)=>{k({isOpen:!0,fieldType:e,onApply:t})},[])),x=(0,s.useCallback)(()=>{k({isOpen:!1,fieldType:"title",onApply:null})},[]),C=(0,s.useCallback)(e=>{N.onApply&&e&&N.onApply(e),x()},[N,x]);return(0,t.createElement)("div",{className:"wpseopilot-editor-panel"},(0,t.createElement)("div",{className:"wpseopilot-score-header"},(0,t.createElement)(m,{score:l?.score||0,level:l?.level||"poor"}),(0,t.createElement)("div",{className:"wpseopilot-score-info"},(0,t.createElement)("div",{className:"wpseopilot-score-label"},"SEO Score"),(0,t.createElement)("div",{className:"wpseopilot-score-status"},l?.issues?.length>0?`${l.issues.length} issue${1!==l.issues.length?"s":""} found`:"Looking good!"))),(0,t.createElement)("div",{className:"wpseopilot-tabs"},(0,t.createElement)("button",{type:"button",className:"wpseopilot-tab "+("general"===_?"active":""),onClick:()=>f("general")},"General"),(0,t.createElement)("button",{type:"button",className:"wpseopilot-tab "+("advanced"===_?"active":""),onClick:()=>f("advanced")},"Advanced"),(0,t.createElement)("button",{type:"button",className:"wpseopilot-tab "+("social"===_?"active":""),onClick:()=>f("social")},"Social")),"general"===_&&(0,t.createElement)("div",{className:"wpseopilot-tab-content"},(0,t.createElement)("div",{className:"wpseopilot-preview-section"},(0,t.createElement)("label",{className:"wpseopilot-section-label"},"Search Preview"),(0,t.createElement)(c,{title:o,description:i,url:n})),(0,t.createElement)("div",{className:"wpseopilot-field wpseopilot-field--keyphrase"},(0,t.createElement)("div",{className:"wpseopilot-field-header"},(0,t.createElement)("label",null,"Focus Keyphrase")),(0,t.createElement)("input",{type:"text",className:"wpseopilot-field-input",value:e.focus_keyphrase||"",onChange:e=>a("focus_keyphrase",e.target.value),placeholder:"Enter your target keyword"}),(0,t.createElement)("p",{className:"wpseopilot-field-help"},"The main keyword you want this page to rank for")),(0,t.createElement)(h,{label:"SEO Title",id:"wpseopilot-seo-title",value:e.title||"",onChange:e=>a("title",e),placeholder:p||"Enter SEO title",maxLength:60,variables:v,variableValues:E,context:"post",showAiButton:b,onAiClick:b?()=>y("title",e=>a("title",e)):null}),(0,t.createElement)(h,{label:"Meta Description",id:"wpseopilot-meta-desc",value:e.description||"",onChange:e=>a("description",e),placeholder:"Enter meta description",maxLength:160,multiline:!0,variables:v,variableValues:E,context:"post",showAiButton:b,onAiClick:b?()=>y("description",e=>a("description",e)):null}),l?.issues?.length>0&&(0,t.createElement)("div",{className:"wpseopilot-issues"},(0,t.createElement)("label",{className:"wpseopilot-section-label"},"Analysis"),(0,t.createElement)("ul",{className:"wpseopilot-issues-list"},l.issues.slice(0,5).map((e,a)=>(0,t.createElement)("li",{key:a,className:`wpseopilot-issue wpseopilot-issue--${e.severity||"warning"}`},(0,t.createElement)("span",{className:"wpseopilot-issue-icon"},"error"===e.severity?"!":"?"),(0,t.createElement)("span",{className:"wpseopilot-issue-text"},e.message)))))),"advanced"===_&&(0,t.createElement)("div",{className:"wpseopilot-tab-content"},(0,t.createElement)("div",{className:"wpseopilot-field"},(0,t.createElement)("div",{className:"wpseopilot-field-header"},(0,t.createElement)("label",null,"Canonical URL")),(0,t.createElement)("input",{type:"url",className:"wpseopilot-field-input",value:e.canonical||"",onChange:e=>a("canonical",e.target.value),placeholder:n}),(0,t.createElement)("p",{className:"wpseopilot-field-help"},"Leave empty to use the default URL")),(0,t.createElement)("div",{className:"wpseopilot-robots-section"},(0,t.createElement)("label",{className:"wpseopilot-section-label"},"Search Engine Visibility"),(0,t.createElement)("label",{className:"wpseopilot-toggle"},(0,t.createElement)("input",{type:"checkbox",checked:e.noindex||!1,onChange:e=>a("noindex",e.target.checked)}),(0,t.createElement)("span",{className:"wpseopilot-toggle-slider"}),(0,t.createElement)("span",{className:"wpseopilot-toggle-label"},"Hide from search results",(0,t.createElement)("small",null,"Add noindex meta tag"))),(0,t.createElement)("label",{className:"wpseopilot-toggle"},(0,t.createElement)("input",{type:"checkbox",checked:e.nofollow||!1,onChange:e=>a("nofollow",e.target.checked)}),(0,t.createElement)("span",{className:"wpseopilot-toggle-slider"}),(0,t.createElement)("span",{className:"wpseopilot-toggle-label"},"Don't follow links",(0,t.createElement)("small",null,"Add nofollow meta tag")))),(0,t.createElement)("div",{className:"wpseopilot-robots-preview"},(0,t.createElement)("label",{className:"wpseopilot-section-label"},"Robots Meta"),(0,t.createElement)("code",{className:"wpseopilot-robots-code"},e.noindex||e.nofollow?`${e.noindex?"noindex":"index"}, ${e.nofollow?"nofollow":"follow"}`:"index, follow (default)"))),"social"===_&&(0,t.createElement)("div",{className:"wpseopilot-tab-content"},(0,t.createElement)("div",{className:"wpseopilot-social-preview"},(0,t.createElement)("label",{className:"wpseopilot-section-label"},"Social Preview"),(0,t.createElement)("div",{className:"wpseopilot-social-card"},(0,t.createElement)("div",{className:"wpseopilot-social-image"},e.og_image||u?(0,t.createElement)("img",{src:e.og_image||u,alt:""}):(0,t.createElement)("div",{className:"wpseopilot-social-placeholder"},(0,t.createElement)("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none"},(0,t.createElement)("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",stroke:"currentColor",strokeWidth:"2"}),(0,t.createElement)("circle",{cx:"8.5",cy:"8.5",r:"1.5",fill:"currentColor"}),(0,t.createElement)("path",{d:"M21 15l-5-5L5 21",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})),(0,t.createElement)("span",null,"No image set"))),(0,t.createElement)("div",{className:"wpseopilot-social-content"},(0,t.createElement)("div",{className:"wpseopilot-social-url"},new URL(n).hostname),(0,t.createElement)("div",{className:"wpseopilot-social-title"},o),(0,t.createElement)("div",{className:"wpseopilot-social-desc"},i||"No description available")))),(0,t.createElement)("div",{className:"wpseopilot-field"},(0,t.createElement)("div",{className:"wpseopilot-field-header"},(0,t.createElement)("label",null,"Social Image URL")),(0,t.createElement)("input",{type:"url",className:"wpseopilot-field-input",value:e.og_image||"",onChange:e=>a("og_image",e.target.value),placeholder:"https://..."}),(0,t.createElement)("p",{className:"wpseopilot-field-help"},"1200x630 recommended. Leave empty to use featured image."),!e.og_image&&u&&(0,t.createElement)("p",{className:"wpseopilot-field-note"},"Using featured image as fallback")),(0,t.createElement)(r.Button,{variant:"secondary",className:"wpseopilot-media-button",onClick:()=>{const e=wp.media({title:"Select Social Image",button:{text:"Use Image"},multiple:!1});e.on("select",()=>{const t=e.state().get("selection").first().toJSON();a("og_image",t.url)}),e.open()}},(0,t.createElement)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",style:{marginRight:"6px"}},(0,t.createElement)("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",stroke:"currentColor",strokeWidth:"2"}),(0,t.createElement)("circle",{cx:"8.5",cy:"8.5",r:"1.5",fill:"currentColor"}),(0,t.createElement)("path",{d:"M21 15l-5-5L5 21",stroke:"currentColor",strokeWidth:"2"})),"Select Image")),(0,t.createElement)(g,{isOpen:N.isOpen,onClose:x,onGenerate:C,fieldType:N.fieldType,currentValue:"title"===N.fieldType?e.title:e.description,postTitle:p,postContent:d,variableValues:E}))},b=()=>(0,t.createElement)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,t.createElement)("path",{d:"M21 16v-2l-8-5V3.5c0-.83-.67-1.5-1.5-1.5S10 2.67 10 3.5V9l-8 5v2l8-2.5V19l-2 1.5V22l3.5-1 3.5 1v-1.5L13 19v-5.5l8 2.5z",fill:"currentColor"})),_=window.wpseopilotEditor||{},f=_.variables||{},N=_.aiEnabled||!1;(0,a.registerPlugin)("wpseopilot",{render:()=>{const[e,a]=(0,s.useState)({title:"",description:"",canonical:"",noindex:!1,nofollow:!1,og_image:"",focus_keyphrase:""}),[i,r]=(0,s.useState)(null),[c,p]=(0,s.useState)(!1),[m,d]=(0,s.useState)(!1),[u,w]=(0,s.useState)({}),{postId:v,postTitle:h,postExcerpt:g,postContent:k,postType:y,postSlug:x,featuredImage:C}=(0,o.useSelect)(e=>{const t=e("core/editor"),a=t.getCurrentPost(),l=t.getEditedPostAttribute("featured_media");let o="";if(l){const t=e("core").getMedia(l);t&&(o=t.source_url)}return{postId:t.getCurrentPostId(),postTitle:t.getEditedPostAttribute("title")||"",postExcerpt:t.getEditedPostAttribute("excerpt")||"",postContent:t.getEditedPostContent()||"",postType:t.getCurrentPostType(),postSlug:a?.slug||"",featuredImage:o}},[]),{editPost:S}=(0,o.useDispatch)("core/editor");(0,s.useEffect)(()=>{if(!v||!y)return;const e={post:"posts",page:"pages",attachment:"media"}[t=y]||t;var t;n()({path:`/wp/v2/${e}/${v}`}).then(e=>{if(e.meta&&e.meta._wpseopilot_meta){const t=e.meta._wpseopilot_meta;a({title:t.title||"",description:t.description||"",canonical:t.canonical||"",noindex:"1"===t.noindex,nofollow:"1"===t.nofollow,og_image:t.og_image||"",focus_keyphrase:t.focus_keyphrase||""})}}).catch(()=>{})},[v,y]),(0,s.useEffect)(()=>{if(!v)return;const e=setTimeout(()=>{n()({path:`/wpseopilot/v2/audit/post/${v}`}).then(e=>{e.success&&e.data&&r(e.data)}).catch(()=>{})},500);return()=>clearTimeout(e)},[v,e,h,k]),(0,s.useEffect)(()=>{const e={post_title:h||"",post_excerpt:g||"",site_title:_.siteTitle||"",tagline:_.tagline||"",separator:_.separator||"-",current_year:(new Date).getFullYear().toString()};w(e)},[h,g]);const M=(0,s.useCallback)((t,l)=>{a(e=>({...e,[t]:l})),d(!0);const o={...e,[t]:l},s={title:o.title,description:o.description,canonical:o.canonical,noindex:o.noindex?"1":"",nofollow:o.nofollow?"1":"",og_image:o.og_image,focus_keyphrase:o.focus_keyphrase};S({meta:{_wpseopilot_meta:s}})},[e,S]),L=e.title||h||"Untitled",T=e.description||g||"",O=window.location.origin,$=x?`${O}/${x}/`:O;return(0,t.createElement)(t.Fragment,null,(0,t.createElement)(l.PluginSidebarMoreMenuItem,{target:"wpseopilot-sidebar",icon:(0,t.createElement)(b,null)},"WP SEO Pilot"),(0,t.createElement)(l.PluginSidebar,{name:"wpseopilot-sidebar",title:"WP SEO Pilot",icon:(0,t.createElement)(b,null)},(0,t.createElement)(E,{seoMeta:e,updateMeta:M,seoScore:i,effectiveTitle:L,effectiveDescription:T,postUrl:$,postTitle:h,postContent:k,featuredImage:C,hasChanges:m,variables:f,variableValues:u,aiEnabled:N})))},icon:(0,t.createElement)(b,null)})})();