// ==========================================================================
// Variable Picker - Template Variable Selection Component
// ==========================================================================

.variable-picker {
    position: relative;
    z-index: @z-dropdown;
}

// Compact mode (inside template inputs)
.variable-picker--compact {
    position: static; // Let dropdown position relative to container
}

.variable-picker__trigger {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: @spacing-sm @spacing-md;
    background: @color-surface;
    border: 1px solid @color-border;
    border-radius: @radius-sm;
    font-size: @font-size-sm;
    font-weight: @font-weight-medium;
    color: @color-text;
    cursor: pointer;
    .transition();
    white-space: nowrap;

    &:hover {
        border-color: @color-primary;
        color: @color-primary;
    }

    &:disabled {
        opacity: 0.5;
        cursor: not-allowed;
    }

    svg {
        flex-shrink: 0;
    }
}

.variable-picker__dropdown {
    .dropdown-base();
    top: calc(100% + 6px);
    right: 0;
    width: 320px;
    max-height: 400px;
    .flex-column();
}

.variable-picker__search {
    padding: @spacing-md;
    border-bottom: 1px solid @color-border;

    input {
        .input-base();
        background: @color-surface-muted;
    }
}

.variable-picker__groups {
    overflow-y: auto;
    max-height: 340px;
}

.variable-picker__group {
    padding: @spacing-sm 0;

    &:not(:last-child) {
        border-bottom: 1px solid @color-border;
    }
}

.variable-picker__group-label {
    padding: 6px @spacing-md;
    font-size: @font-size-xs;
    font-weight: @font-weight-bold;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: @color-muted;
}

.variable-picker__items {
    .flex-column();
}

.variable-picker__item {
    .flex-column();
    gap: 2px;
    padding: @spacing-sm @spacing-md;
    text-align: left;
    background: none;
    border: none;
    cursor: pointer;
    .transition-fast(background);

    &:hover {
        background: @color-surface-muted;
    }
}

.variable-picker__item-header {
    display: flex;
    align-items: center;
    gap: @spacing-sm;
}

// Tag colors matching template-input pills
@tag-global: #2271b1;
@tag-post: #7c3aed;
@tag-taxonomy: #059669;
@tag-author: #ea580c;
@tag-archive: #0891b2;

.variable-picker__tag {
    font-family: @font-family-mono;
    font-size: 11px;
    padding: 2px 6px;
    background: fade(@tag-global, 12%);
    color: @tag-global;
    border-radius: 4px;

    // Color variants by group
    &--global {
        background: fade(@tag-global, 12%);
        color: @tag-global;
    }

    &--post {
        background: fade(@tag-post, 12%);
        color: @tag-post;
    }

    &--taxonomy {
        background: fade(@tag-taxonomy, 12%);
        color: @tag-taxonomy;
    }

    &--author {
        background: fade(@tag-author, 12%);
        color: @tag-author;
    }

    &--archive {
        background: fade(@tag-archive, 12%);
        color: @tag-archive;
    }
}

// Group label colors
.variable-picker__group-label {
    &--global { color: @tag-global; }
    &--post { color: @tag-post; }
    &--taxonomy { color: @tag-taxonomy; }
    &--author { color: @tag-author; }
    &--archive { color: @tag-archive; }
}

.variable-picker__label {
    font-size: @font-size-sm;
    font-weight: @font-weight-medium;
    color: @color-text;
}

.variable-picker__preview {
    font-size: @font-size-sm;
    color: @color-muted;
    padding-left: 0;
    .text-truncate();
}

.variable-picker__empty {
    padding: @spacing-xl;
    text-align: center;
    color: @color-muted;
    font-size: @font-size-sm;
}

// Compact dropdown (used inside template inputs)
.variable-picker__dropdown--compact {
    position: absolute;
    top: calc(100% + 8px);
    right: 0;
    z-index: @z-modal; // Higher than other fields
    width: 320px;
    max-height: 400px;
    background: @color-surface;
    border: 1px solid @color-border;
    border-radius: @radius-lg;
    box-shadow: @shadow-xl;
    overflow: hidden;
    .flex-column();

    // Search input inside compact dropdown
    .variable-picker__search {
        padding: @spacing-md;
        border-bottom: 1px solid @color-border;
        background: @color-surface;

        input {
            width: 100%;
            padding: @spacing-sm @spacing-md;
            border: 1px solid @color-border;
            border-radius: @radius-md;
            background: @color-surface-muted;
            font-family: inherit;
            font-size: @font-size-sm;
            color: @color-text;

            &::placeholder {
                color: @color-muted;
            }

            &:focus {
                outline: none;
                border-color: @color-primary;
                background: @color-surface;
            }
        }
    }

    .variable-picker__groups {
        overflow-y: auto;
        max-height: 320px;
        background: @color-surface;
    }

    .variable-picker__item {
        width: 100%;
        font-family: inherit;
    }
}

// Responsive
@media (max-width: @breakpoint-sm) {
    .variable-picker__dropdown,
    .variable-picker__dropdown--compact {
        width: 280px;
        right: 0;
        left: auto;
    }
}
